(this.webpackJsonptattle=this.webpackJsonptattle||[]).push([[0],{156:function(e,t,a){},163:function(e,t,a){},166:function(e,t,a){},167:function(e,t,a){},168:function(e,t,a){},169:function(e,t,a){},171:function(e,t,a){},172:function(e,t,a){},173:function(e,t,a){},174:function(e,t,a){},175:function(e,t,a){},193:function(e,t,a){},194:function(e,t,a){},197:function(e,t,a){},198:function(e,t,a){},199:function(e,t,a){},200:function(e,t,a){},201:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(14),l=a.n(r),c=(a(156),a(7)),i=Object(n.createContext)(),s=function(e){var t=e.reducer,a=e.initialState,r=e.children;return o.a.createElement(i.Provider,{value:Object(n.useReducer)(t,a)},r)},m=function(){return Object(n.useContext)(i)},u=a(45),d=a(25),p=a(63),h=p.a.initializeApp({apiKey:"AIzaSyCF7lHw_Z7DmZgpoZuYIGveD0eZ8ha7Qyg",authDomain:"tattle-9359.firebaseapp.com",databaseURL:"https://tattle-9359-default-rtdb.firebaseio.com/",projectId:"tattle-9359",storageBucket:"tattle-9359.appspot.com",messagingSenderId:"849640668400",appId:"1:849640668400:web:91c77b3a931a325ef4d635",measurementId:"G-17X1MHRTRX"}).firestore(),E=p.a.auth(),f=new p.a.auth.GoogleAuthProvider,g=p.a.storage(),v=h;function b(e){return{type:"SET_USER",user:e}}var _=a(74),w=function(e,t,a){_.b.info(e,{toastId:t,position:a,autoClose:5e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})},y=a(117),O=a.n(y),j=a.p+"static/media/logo.882da599.png";a(163);var A=function(){return o.a.createElement("div",{className:"login"},o.a.createElement("div",{className:"login__container"},o.a.createElement("img",{src:j,alt:"Tattle Logo"}),o.a.createElement("div",{className:"login__text"},o.a.createElement("h2",null,"Keeps you Connected"),o.a.createElement("br",null),o.a.createElement("p",null,"Tattle is driven by a fascination for communication "),o.a.createElement("p",null,"technology that was once viewed as a passing trend.")),o.a.createElement("div",{className:"login__withGoogle",onClick:function(){E.signInWithPopup(f).catch((function(e){return w("".concat(e),"google","top-center")}))}},o.a.createElement("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgEAQAAACJ4248AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QAAKqNIzIAAAAJcEhZcwAAAGAAAABgAPBrQs8AAAAHdElNRQflBgUJNAZvW0hOAAACwklEQVRYw7WXyy8zURjGnzNudQmJWFDilrQo1RVdYCUiJJYi/hkScQkLka5orKiwtLMgIZEgQ1K1EQsLScu4JYo00cR5vsW4fGGmnWLe3eTMeX/P854z58wrYDHIwkJgYADo7ATa2wGnEygtBaWEuLkBNA04OgI3N4HtbaE8P1vNnQZcW0suLpJPT7Qa8vmZnJujrK7+OVjm5ZHT0+TLi2Xwt0gmybExypycDOEuF3l8/HPw14rs75P5+RZL7vGQsdifwRmPUw4MWITX1VHe3v6d89NTSrc7FTP7E15QAKyvQ5SVpZd6egqoKhCL6c9OJ+D3A01Nn242NoDhYaHE4xbXfXIyjR1JLi1Rer3mOVpayFCIcmaGzMrKYNO53WQiYQ6/uyO7uy0nzDTIhYXU8IYG++CyuNjcvZS2OtfdDw2Zu19ethWuVyAYNIZrGmVrq/0CqKrGAs7OrM1fWfn5QbG7qwA1Ncap9/Zsd4/ycgUoKTG2dnVlO58VFQpAGg4KRbFdgMjOVoCHB7Py2C4A8bgCXlwYD3Z02C/g/DwbIhzWL5KvUV9P6fMJJRJJmYOBALC+bjoumpuB0VHjwUgElIODxp/I6ysZCv3WI7m6av4Z9veDsqgo5VEse3p+DJe9vfpxbhRPT6TD8aZyft5c5f096fFkDm9tTf1zEwj897LLpd96KURkUAmyry91vkSCdDq/TBofT31sSqn/bPh85q69XnJtzbzs7zEx8T5HfApwOICDA8Ac8BlnZ4CqgtEoBAlUVoJ+P0RjY/q5qgp2dQklmTRwUFNDahpti6srSrO756MSHg8Zjf49/PLS8mYm6+spw+G/g5+ckLW1Vjfx23Lk5pJTU79vzUZGMm7Nvu0LGQySj4/WwY+PlLOzVppTYUWEviwFBR/tOdvaIKqqPtpzXF9DaBpweAhubQE7O1bb838OXQJoAVmSXQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMS0wNi0wNVQwOTo1MjowNiswMDowMG3Wl5oAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjEtMDYtMDVUMDk6NTI6MDYrMDA6MDAciy8mAAAAAElFTkSuQmCC",alt:"Google Logo"}),o.a.createElement("span",null,"Sign in with Google")),o.a.createElement("div",{className:"login__withGoogle login__Anonymously",onClick:function(){E.signInAnonymously().catch((function(e){return w("".concat(e),"anonymous","top-center")}))}},o.a.createElement(O.a,null),o.a.createElement("span",null,"Login Anonymously"))))},N=a(257);var C=function(e){var t=e.photoURL,a=e.onClick;return o.a.createElement("div",{style:{cursor:"pointer"}},o.a.createElement(N.a,{src:t,onClick:a}))},S=a(256),k=a(241);var x=function(e){var t=e.name,a=e.icon,n=e.onClick;return o.a.createElement("div",null,o.a.createElement(S.a,{title:o.a.createElement("span",{style:{fontSize:"14px",padding:"8px 5px 8px 5px"}},t),placement:"bottom-end"},o.a.createElement(k.a,{onClick:n},a)))},R=a(245),L=a(254),D=a(242),I=a(244),T=a(243),M=a(258),U=a(119),P=a.n(U);var F=function(e){var t=e.user,a=e.db,r=e.firebase,l=Object(n.useState)(""),i=Object(c.a)(l,2),s=i[0],m=i[1],u=Object(n.useState)(!1),d=Object(c.a)(u,2),p=d[0],h=d[1],E=function(){h(!1),m("")};return o.a.createElement("div",null,o.a.createElement(x,{name:"New Chat",onClick:function(){h(!0)},icon:o.a.createElement(P.a,null)}),o.a.createElement(D.a,{open:p,onClose:E,"aria-labelledby":"form-dialog-title"},o.a.createElement(M.a,{id:"form-dialog-title"},"Create Chat Room"),o.a.createElement(T.a,null,o.a.createElement(L.a,{autoFocus:!0,margin:"dense",id:"name",label:"Room Name",type:"text",fullWidth:!0,value:s,onChange:function(e){return m(e.target.value)}})),o.a.createElement(I.a,null,o.a.createElement(R.a,{onClick:E,color:"primary"},"Cancel"),o.a.createElement(R.a,{onClick:function(e){e.preventDefault(),s&&a.collection("rooms").add({roomOwner:t.uid,createdBy:t.displayName,name:s,timestamp:r.firestore.FieldValue.serverTimestamp()}).then((function(e){a.collection("rooms").doc(e.id).set({id:e.id},{merge:!0})})).catch((function(e){console.error("Error adding document: ",e)})),h(!1),m("")},color:"primary",disabled:!s},"Create"))))},B=a(120),V=a.n(B);var G=function(){return o.a.createElement("div",null,o.a.createElement(x,{name:"Status",icon:o.a.createElement(V.a,null)}))},W=a(136),J=a(259);var Q=function(e){var t=e.menuLists,a=e.menu,n=e.handleMenuClose;return o.a.createElement("div",null,o.a.createElement(W.a,{id:"simple-menu",anchorEl:a,keepMounted:!0,open:Boolean(a),onClose:n,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},getContentAnchorEl:null},t.map((function(e){return o.a.createElement(J.a,{key:e.id,onClick:e.onClick},e.title)}))))},z=a(62),Y=a.n(z),Z=a(82),H=a(246),K=a(43),q=a.n(K);a(166);var X=function(e){var t=e.open,a=e.close,n=e.user,r=e.photo;return o.a.createElement(D.a,{open:t,fullScreen:!0,onClose:a,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},o.a.createElement(M.a,{id:"alert-dialog-title-dialogCustom"},o.a.createElement("div",null,o.a.createElement(N.a,{src:n.photoURL})),o.a.createElement("div",null,o.a.createElement(k.a,{edge:"end",color:"inherit",onClick:a,"aria-label":"close"},o.a.createElement(q.a,null)))),o.a.createElement(T.a,null,o.a.createElement(H.a,{in:t,style:{transitionDelay:t?"300ms":"0ms"}},o.a.createElement("img",{src:r,alt:"",className:"DialogCustom__photo"}))))},$=a(248),ee=a(247),te=a(55),ae=a.n(te),ne=a(83),oe=a.n(ne),re=a(96),le=a.n(re),ce=a(87),ie=a.n(ce),se=(a(167),Object(ee.a)((function(e){return{root:{display:"flex"},drawerPaper:{position:"absolute"}}})));var me=function(e){var t=e.drawerLeft,a=e.setDrawerLeft,r=e.db,l=e.auth,i=e.storage,s=se(),u=m(),d=Object(c.a)(u,1)[0].user,p=Object(n.useState)(""),h=Object(c.a)(p,2),E=h[0],f=h[1],g=Object(n.useState)(""),v=Object(c.a)(g,2),b=v[0],_=v[1],y=Object(n.useState)(!1),O=Object(c.a)(y,2),j=O[0],A=O[1],C=Object(n.useState)(!1),S=Object(c.a)(C,2),x=S[0],R=S[1],L=Object(n.useState)(!1),U=Object(c.a)(L,2),P=U[0],F=U[1],B=Object(n.useState)(null),V=Object(c.a)(B,2),G=V[0],W=V[1],J=Object(n.useState)(!1),z=Object(c.a)(J,2),K=z[0],q=z[1],ee=Object(n.useState)(null),te=Object(c.a)(ee,2),ne=te[0],re=te[1],ce=Object(n.useState)(""),me=Object(c.a)(ce,2),ue=me[0],de=me[1];Object(n.useEffect)((function(){f(d.displayName),r.collection("users").doc(d.uid).onSnapshot((function(e){var t,a;de(null===(t=e.data())||void 0===t?void 0:t.photoURL),_(null===(a=e.data())||void 0===a?void 0:a.about)}))}),[d.uid,d.displayName,r]);var pe=function(){var e=Object(Z.a)(Y.a.mark((function e(t){var a,n,o,r,l,c;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("imageFileSizeToastId",!((a=t.target.files[0]).size>3145728)){e.next=6;break}w("Image should not exceed more than 3Mb","imageFileSizeToastId","top-center"),e.next=30;break;case 6:if(n=i.ref(),!0!==d.isAnonymous){e.next=20;break}return o=n.child("user/anonymous/".concat(d.uid)),r=o.child(a.name),e.next=12,r.put(a);case 12:return e.t0=W,e.next=15,r.getDownloadURL();case 15:e.t1=e.sent,(0,e.t0)(e.t1),console.log("uploading image",G),e.next=30;break;case 20:return l=n.child("user/regular/".concat(d.uid)),c=l.child(a.name),e.next=24,c.put(a);case 24:return e.t2=W,e.next=27,c.getDownloadURL();case 27:e.t3=e.sent,(0,e.t2)(e.t3),console.log("uploading image",G);case 30:re(null),q(!0);case 32:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),he=function(){G?(l.currentUser.updateProfile({photoURL:G}),r.collection("users").doc(d.uid).set({photoURL:G},{merge:!0}),q(!1)):w("Select photo to upload!","uploadPhotoError","top-center")},Ee=[{title:"View Photo",onClick:function(){return d?F(!0):w("You have no photo!","viewPhoto","top-center"),void re(null)},id:1e5*Math.random()},{title:"Take photo",onClick:function(){w("Take photo is not yet available!","takePhoto","top-center")},id:1e5*Math.random()},{title:o.a.createElement("div",{className:"profileMenu_uploadPhoto"},o.a.createElement("label",{htmlFor:"file-input"},"Upload photo"),o.a.createElement("input",{id:"file-input",type:"file",onChange:pe,accept:"image/*"})),onClick:function(){return he()},id:1e5*Math.random()},{title:"Removed photo",onClick:function(){w("Removed photo is not yet available!","removedPhoto","top-center")},id:1e5*Math.random()}];return o.a.createElement("div",null,o.a.createElement($.a,{anchor:"left",variant:"persistent",open:t,classes:{paper:s.drawerPaper}},o.a.createElement("div",{className:"drawerLeft__header"},o.a.createElement("div",{className:"drawerLeft__header_container"},o.a.createElement(k.a,{onClick:function(){a(!1),A(!1),R(!1)}},o.a.createElement(oe.a,null)),o.a.createElement("p",null,"Profile"))),o.a.createElement("div",{className:"drawerLeft__content"},o.a.createElement("div",{className:"drawerLeft__content_photo"},o.a.createElement("div",{className:"profilePhoto"},o.a.createElement(H.a,{in:t,style:{transitionDelay:t?"300ms":"0ms"}},ue?o.a.createElement(N.a,{src:ue,className:"profilePhoto__layer_bottom"}):o.a.createElement(N.a,null)),o.a.createElement("div",{className:"profilePhoto__layer_top",onClick:function(e){re(e.currentTarget)}},o.a.createElement("div",{className:"profilePhoto__text"},o.a.createElement(ae.a,null),o.a.createElement("p",null,"CHANGE"),o.a.createElement("p",null,"PROFILE PHOTO")))),o.a.createElement(Q,{menuLists:Ee,menu:ne,handleMenuClose:function(){re(null)}}),o.a.createElement(X,{open:P,close:function(){F(!1)},photo:ue,user:d})),o.a.createElement("div",{className:"profileMenu__diaglog"},o.a.createElement(D.a,{open:K,onClose:function(){q(!1)},"aria-labelledby":"form-dialog-title"},o.a.createElement(M.a,{id:"form-dialog-title-drawerLeft"},"Upload Photo"),o.a.createElement(T.a,{id:"form-dialog-content"},o.a.createElement("div",{className:"profileMenu__uploadPhoto_dialog"},o.a.createElement("img",{src:G,alt:""}))),o.a.createElement(I.a,null,o.a.createElement("div",{className:"profileMenu_uploadPhoto_iconButton"},o.a.createElement(k.a,{onClick:he},o.a.createElement(ie.a,null)))))),o.a.createElement("div",{className:"drawerLeft__content_name"},o.a.createElement("p",null,"Your Name"),o.a.createElement("form",null,j?o.a.createElement(o.a.Fragment,null,o.a.createElement("input",{value:E,onChange:function(e){return f(e.target.value)},type:"text",styles:{borderBottom:"1px solid green !important"}}),o.a.createElement(ie.a,{onClick:function(e){e.preventDefault(),d.uid&&(r.collection("users").doc(d.uid).update({name:E}).then((function(){console.log("Document successfully updated!")})).catch((function(e){console.error("Error updating document: ",e)})),l.currentUser.updateProfile({displayName:E})),A(!1)}})):o.a.createElement(o.a.Fragment,null,o.a.createElement("span",null,E),o.a.createElement(le.a,{onClick:function(){A(!0)}})))),o.a.createElement("div",{className:"drawerLeft__note"},o.a.createElement("span",null,"This is not your username or pin. This name will be visible to your Tattle contacts.")),o.a.createElement("div",{className:"drawerLeft__content_name"},o.a.createElement("p",null,"About"),o.a.createElement("form",null,x?o.a.createElement(o.a.Fragment,null,o.a.createElement("input",{value:b,onChange:function(e){return _(e.target.value)},type:"text"}),o.a.createElement(ie.a,{onClick:function(e){e.preventDefault(),d.uid&&r.collection("users").doc(d.uid).update({about:b}).then((function(){console.log("Document successfully updated!")})).catch((function(e){console.error("Error updating document: ",e)})),R(!1)}})):o.a.createElement(o.a.Fragment,null,o.a.createElement("span",null,b),o.a.createElement(le.a,{onClick:function(){R(!0)}})))))))},ue=a(84),de=a.n(ue),pe=a(121),he=a.n(pe);a(168);var Ee=function(e){var t=e.placeholder,a=e.setSearch,r=e.search,l=Object(n.useState)(!1),i=Object(c.a)(l,2),s=i[0],m=i[1];return o.a.createElement("div",{className:"search ".concat(!0===s&&"search__bgColorChange")},o.a.createElement("div",{className:"search__container"},o.a.createElement("span",{className:"".concat(!0===s?"arroww":"")},s?o.a.createElement(he.a,null):o.a.createElement(de.a,null)),o.a.createElement("input",{value:r,onChange:function(e){return a(e.target.value)},type:"text",placeholder:t,required:!0,onFocus:function(){m(!0)},onBlur:function(){m(!1)}})))},fe=a(122),ge=a.n(fe);a(169);var ve=function(e){var t,a,r,l,i=e.id,s=e.name,m=Object(n.useState)([]),d=Object(c.a)(m,2),p=d[0],h=d[1];return Object(n.useEffect)((function(){i&&v.collection("rooms").doc(i).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){return h(e.docs.map((function(e){return e.data()})))}))}),[i]),o.a.createElement(u.b,{to:"/rooms/".concat(i),className:"sidebarChat__link"},o.a.createElement("div",{className:"sidebarChat"},o.a.createElement(N.a,null,s[0]),o.a.createElement("div",{className:"sidebarChat__info"},o.a.createElement("h2",null,s),(null===(t=p[0])||void 0===t?void 0:t.photo)?o.a.createElement("div",{className:"sideChat__photo"},o.a.createElement(ae.a,null)," ",o.a.createElement("span",null,"Photo")):null,(null===(a=p[0])||void 0===a?void 0:a.video)?o.a.createElement("div",{className:"sideChat__photo"},o.a.createElement(ge.a,null)," ",o.a.createElement("span",null,"Video")):null,o.a.createElement("p",null,null===(r=p[0])||void 0===r?void 0:r.message),o.a.createElement("p",null,null===(l=p[0])||void 0===l?void 0:l.url))))},be=a(249),_e=a(85),we=a.n(_e);a(171);var ye=function(e){var t=e.rooms,a=e.setIsRoomExist,r=e.isRoomExist,l=Object(d.g)(),i=Object(d.h)().roomId,s=m(),u=Object(c.a)(s,1)[0].user,h=Object(n.useState)(""),f=Object(c.a)(h,2),b=f[0],_=f[1],y=Object(n.useState)(!1),O=Object(c.a)(y,2),j=O[0],A=O[1],N=Object(n.useState)(!1),S=Object(c.a)(N,2),k=S[0],R=S[1],L=Object(n.useState)(!1),D=Object(c.a)(L,2),I=D[0],T=D[1],M=Object(n.useState)(null),U=Object(c.a)(M,2),P=U[0],B=U[1],V=Object(n.useState)(!1),W=Object(c.a)(V,2),J=W[0],z=W[1],Y=function(e){return function(t){return(t.data.name+"").toLowerCase().includes(e.toLowerCase())||!e}};Object(n.useEffect)((function(){b&&(o.a.createElement(o.a.Fragment,null,t.filter(Y(b)).map((function(e){return o.a.createElement("p",{key:e.id},e.name)}))).props.children.length>0?z(!0):z(!1));if(t){var e=t.findIndex((function(e,t){return e.id===i}));e>=0?a(e):-1===e&&(a(e),l.push("/"))}}),[b,t,i,l,a]),Object(n.useEffect)((function(){t&&(t.length>0?(R(!1),A(!0)):0===t.length&&-1===r&&(R(!0),A(!0)))}),[r,t]);var Z=function(){B(null),T(!0)},H=function(e){B(e.currentTarget)},K=[{title:"Profile",onClick:function(){return Z()},id:1e5*Math.random()},{title:"Archived",onClick:function(){w("Archive is not yet available!","archive","top-center")},id:1e5*Math.random()},{title:"Starred",onClick:function(){w("Starred is not yet available!","starred","top-center")},id:1e5*Math.random()},{title:"Settings",onClick:function(){w("Settings is not yet available!","settings","top-center")},id:1e5*Math.random()},{title:"Logout",onClick:function(){!0===u.isAnonymous?E.currentUser.delete().then((function(){l.push("/")})).catch((function(e){console.log("error deleting anonymous user",e)})):E.signOut()},id:1e5*Math.random()}];return o.a.createElement("div",{className:"sidebar"},o.a.createElement("div",{className:"sidebar__header"},o.a.createElement(C,{id:"UserProfile",photoURL:u.photoURL,onClick:function(){return Z()}}),o.a.createElement(me,{drawerLeft:I,setDrawerLeft:T,db:v,auth:E,storage:g}),o.a.createElement("div",{className:"sidebar__headerRight"},o.a.createElement(G,null),o.a.createElement(F,{db:v,user:u,firebase:p.a}),o.a.createElement(x,{name:"Menu",icon:o.a.createElement(we.a,null),onClick:H}),o.a.createElement(Q,{menuLists:K,menu:P,handleMenuOpen:H,handleMenuClose:function(){B(null)}}))),o.a.createElement(Ee,{search:b,setSearch:_,placeholder:"Search or start new chat"}),o.a.createElement("div",{className:"sidebar__chats"},j?o.a.createElement(o.a.Fragment,null,b?o.a.createElement(o.a.Fragment,null,J?o.a.createElement("div",null,t.filter(Y(b)).map((function(e){return o.a.createElement(ve,{key:e.id,id:e.id,name:e.data.name})}))):o.a.createElement("div",{className:"sidebar__chatsContainer_empty"},o.a.createElement("span",null,"No chat room found"))):o.a.createElement(o.a.Fragment,null,t.map((function(e){return o.a.createElement(ve,{key:e.id,id:e.id,name:e.data.name})})))):o.a.createElement("div",{className:"sidebar__chatsContainer_loading"},o.a.createElement("div",null,o.a.createElement(be.a,null))),k&&j?o.a.createElement("div",{className:"sidebar__chatsContainer_empty"},o.a.createElement("span",null,"No chats")):null))},Oe=a(13),je=(a(172),Object(ee.a)((function(e){var t;return{root:{display:"flex"},drawerPaper:(t={},Object(Oe.a)(t,e.breakpoints.only("xs"),{width:"100vw"}),Object(Oe.a)(t,e.breakpoints.up("sm"),{position:"absolute"}),t)}})));var Ae=function(e){var t=e.content,a=e.drawerRight,n=je();return o.a.createElement("div",null,o.a.createElement($.a,{anchor:"right",variant:"persistent",open:a,classes:{paper:n.drawerPaper}},t))},Ne=a(250),Ce=a(68),Se=a.n(Ce);a(173);var ke=function(e){var t=e.drawerRightSearch,a=e.setDrawerRightSearch,r=e.messages,l=e.user,i=Object(n.useState)(""),s=Object(c.a)(i,2),m=s[0],u=s[1],d=Object(n.useState)(!1),p=Object(c.a)(d,2),h=p[0],E=p[1],f=function(e){return function(t){return(t.message+""+t.caption).toLowerCase().includes(e.toLowerCase())||!e}};return Object(n.useEffect)((function(){m&&(o.a.createElement(o.a.Fragment,null,r.filter(f(m)).map((function(e){return o.a.createElement("p",{key:e.id},e.message,e.caption)}))).props.children.length>0?(E(!0),console.log("search message sucess")):(E(!1),console.log("search message fail")))}),[m,r]),o.a.createElement("div",null,o.a.createElement(Ae,{drawerRight:t,content:o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"drawerRight__header"},o.a.createElement(k.a,{onClick:function(){a(!1)}},o.a.createElement(q.a,null)),o.a.createElement("p",null,"Search Messages")),o.a.createElement(Ee,{search:m,setSearch:u,placeholder:"Search..."}),o.a.createElement("div",{className:"drawerRight__content ".concat(!0===h&&m.length>0&&"drawerRight__content_searched")},m.length>0?o.a.createElement(o.a.Fragment,null,h?o.a.createElement(o.a.Fragment,null,r.filter(f(m)).map((function(e){var t;return o.a.createElement("div",{key:e.id,className:"drawerRight__content_searched_message"},o.a.createElement("p",null,new Date(null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toLocaleTimeString("en-US",{hour:"numeric",hour12:!0,minute:"numeric"}),o.a.createElement("br",null)),o.a.createElement("p",{id:"last_p"},e.uid===l.uid?o.a.createElement(Se.a,null):null,e.message,e.caption),o.a.createElement(Ne.a,null))}))):o.a.createElement("p",null,"No message found")):o.a.createElement("p",null,"Search for messages in this room.")))}))},xe=a(123),Re=a.n(xe);a(174);var Le=function(e){var t=e.drawerRightInfo,a=e.setDrawerRightInfo,r=e.messages,l=(e.user,Object(n.useState)("")),i=Object(c.a)(l,2),s=i[0],m=(i[1],Object(n.useState)(!1)),u=Object(c.a)(m,2),d=(u[0],u[1]);return Object(n.useEffect)((function(){s&&(function(){return o.a.createElement(o.a.Fragment,null,r.filter((e=s,function(t){return(t.message+""+t.caption).toLowerCase().includes(e.toLowerCase())||!e})).map((function(e){return o.a.createElement("p",{key:e.id},e.message,e.caption)})));var e}().props.children.length>0?(d(!0),console.log("search message sucess")):(d(!1),console.log("search message fail")))}),[s,r]),o.a.createElement("div",null,o.a.createElement(Ae,{drawerRight:t,content:o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"drawer-right-info__header"},o.a.createElement(k.a,{onClick:function(){a(!1)}},o.a.createElement(q.a,null)),o.a.createElement("p",null,"Group Info")),o.a.createElement("div",{className:"drawer-right-info-content"},o.a.createElement("div",{className:"drawer-right-info-content__photo"},o.a.createElement("div",{className:"profilePhoto"},o.a.createElement(H.a,{in:t,style:{transitionDelay:t?"300ms":"0ms"}},o.a.createElement(N.a,null,o.a.createElement(Re.a,null))),o.a.createElement("div",{className:"profilePhoto__layer_top"},o.a.createElement("div",{className:"profilePhoto__text"},o.a.createElement(ae.a,null),o.a.createElement("p",null,"CHANGE"),o.a.createElement("p",null,"PROFILE PHOTO")))))))}))},De=a(255);a(175);var Ie=function(e){var t=e.roomCreatedBy,a=e.roomOwner,r=e.roomName,l=e.roomId,i=(e._roomId,e.messages),s=e.db,d=e.history,p=e.isRoomExist,h=m(),E=Object(c.a)(h,1)[0].user,f=Object(n.useState)(!1),g=Object(c.a)(f,2),v=g[0],b=g[1],_=Object(n.useState)(!1),y=Object(c.a)(_,2),O=y[0],j=y[1],A=Object(n.useState)(null),C=Object(c.a)(A,2),S=C[0],R=C[1],L=Object(n.useState)(""),D=Object(c.a)(L,2),I=D[0],T=D[1],M=Object(n.useState)(!1),U=Object(c.a)(M,2),P=U[0],F=U[1],B=Object(n.useState)(!1),V=Object(c.a)(B,2),G=V[0],W=V[1];Object(n.useEffect)((function(){var e;E.uid&&s.collection("users").doc(E.uid).get().then((function(e){e.exists&&T(e.data().role)})).catch((function(e){w("".concat(e),"errorAbout","top-center")})),(null===(e=i[i.length-1])||void 0===e?void 0:e.timestamp)?F(!0):F(!1),i[i.length-1]?W(!0):W(!1),p>=0&&(j(!1),b(!1))}),[E.uid,E.displayName,E.isAnonymous,s,i,l,p]);var J=function(e){R(e.currentTarget)},z=[{title:"Contact info",onClick:function(){return j(!0),void R(null)},id:1e5*Math.random()},{title:"Select messages",onClick:function(){w("Select Messages is not yet  available!","selectMessages","top-center")},id:1e5*Math.random()},{title:"Mute notifications",onClick:function(){w("Mute Notifications is not yet available!","muteNotifications","top-center")},id:1e5*Math.random()},{title:"Clear messages",onClick:function(){w("Clear Messages is not yet available!","clearMessages","top-center")},id:1e5*Math.random()},{title:"Delete Room",onClick:function(){return function(){var e="roomDeleted";a===E.uid||"admin"===I?(s.collection("rooms").doc(l).delete().then((function(){w("Room successfully deleted!",e,"top-center")})).catch((function(t){w("Error removing room! ".concat(t),e,"top-center")})),d.push("/")):w("You are not allowed to delete room ".concat(r,". Only the admin or room owner ").concat(t),e,"top-center")}()},id:1e5*Math.random()}];return o.a.createElement("div",{className:"chat__header"},o.a.createElement(ke,{drawerRightSearch:v,setDrawerRightSearch:b,roomId:l,messages:i,db:s,user:E}),o.a.createElement(Le,{drawerRightInfo:O,setDrawerRightInfo:j,roomId:l,messages:i,db:s,user:E}),o.a.createElement(De.a,{smUp:!0},o.a.createElement(u.b,{to:"/"},o.a.createElement("div",{className:"chat__back_button"},o.a.createElement(k.a,null,o.a.createElement(oe.a,null))))),o.a.createElement(N.a,null,r[0]),o.a.createElement("div",{className:"chat__headerInfo"},o.a.createElement("h3",null,r),G?o.a.createElement(o.a.Fragment,null,P?o.a.createElement("p",null,"Last seen ",function(){var e,t;return new Date(null===(e=i[i.length-1])||void 0===e||null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toLocaleTimeString([],{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",hour12:!0,minute:"numeric"})}()):o.a.createElement("p",null,"Last seen ",(new Date).toLocaleTimeString([],{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",hour12:!0,minute:"numeric"}))):null),o.a.createElement("div",{className:"chat__headerRight"},o.a.createElement(x,{name:"Search",icon:o.a.createElement(de.a,null),onClick:function(){b(!0)}}),o.a.createElement(x,{name:"Menu",icon:o.a.createElement(we.a,null),onClick:J}),o.a.createElement(Q,{menuLists:z,menu:S,handleMenuOpen:J,handleMenuClose:function(){R(null)}})))},Te=a(86),Me=a.n(Te),Ue=a(124),Pe=a.n(Ue),Fe=a(125),Be=a.n(Fe);a(193);var Ve=function(e){var t=e.roomOwner,a=e.roomCreatedBy,r=e.messages,l=e.user,i=e.roomId,s=e.isRoomExist,m=Object(n.useRef)(null),u=Object(n.useState)(!1),d=Object(c.a)(u,2),p=d[0],h=d[1];Object(n.useEffect)((function(){s>=0&&h(!1)}),[s]);var E=function(){h(!0)},f=function(){h(!1)};return Object(n.useEffect)((function(){i&&m.current.scrollIntoView({behavior:"auto"})}),[r,i]),o.a.createElement("div",null,o.a.createElement("p",{className:"chat__message_reminder"},o.a.createElement(Pe.a,null)," Welcome to Tattle. Messages are not encrpyted."),o.a.createElement("p",{className:"chat__message_reminder chat__createdBy"},t===l.uid?"You created this group":"".concat(a," created this group")),r.map((function(e){return o.a.createElement("div",{key:e.id,className:"chat__message \n                    ".concat(e.uid===l.uid&&"chat__sender"," \n                    ").concat(e.photo&&"chat__message_media_image","\n                    ").concat(e.video&&"chat__message_media_video","\n                    ").concat(e.video&&!e.caption&&"chat__message_media_video_noCaption"," ")},o.a.createElement("span",{className:"chat__name ".concat(e.uid===l.uid&&"chat__name_sender")},e.name),o.a.createElement("div",{className:"chat__body_image_container"},e.photo?o.a.createElement(o.a.Fragment,null,o.a.createElement("img",{alt:"",className:"chat__body_image",src:e.photo})):null),o.a.createElement("div",{className:"chat__body_video_container"},e.video?o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"player-wrapper"},o.a.createElement(Me.a,{className:"react-player",width:"100%",height:"100%",url:e.video,controls:!0,onPlay:E,onPause:f,onEnded:f}))):null),o.a.createElement("div",{className:"chat__message_box"},o.a.createElement("div",{className:"chat__message_box_text ".concat(e.uid===l.uid&&"chat__message_box_text_sender","\n              ").concat(e.photo&&!e.caption&&"chat__message_box_text_no_caption"," ")},e.message?e.message:null,e.caption?e.caption:null,e.url?o.a.createElement("a",{target:"_blank",href:"".concat(e.url),rel:"noopener noreferrer"},e.url):null,o.a.createElement("div",{className:"chat__timestamp_container ".concat(e.uid===l.uid&&"chat__timestamp_container_sender")},e.timestamp?o.a.createElement("div",{className:"chat__timestamp \n                                    ".concat(e.photo&&!e.caption&&"chat__timestamp_media_photo","  \n                                    ").concat(e.video&&!e.caption&&"chat__timestamp_media_video","\n                                    ").concat(e.video&&!e.caption&&!0===p&&"chat__timestamp_media_displayNone")},o.a.createElement("span",null,new Date(e.timestamp.toDate()).toLocaleTimeString("en-US",{hour:"numeric",hour12:!0,minute:"numeric"}),e.uid===l.uid?o.a.createElement(Se.a,null):null)):o.a.createElement("div",{className:"chat__timestamp"},o.a.createElement("span",null,(new Date).toLocaleTimeString("en-US",{hour:"numeric",hour12:!0,minute:"numeric"}),e.uid===l.uid?o.a.createElement(Be.a,null):null))))))})),o.a.createElement("div",{ref:m}))},Ge=a(251),We=a(126),Je=a.n(We),Qe=(a(194),Object(ee.a)((function(e){var t;return{root:{display:"flex"},drawerPaper:{position:"absolute",width:"100%"},paperAnchorBottom:(t={left:"auto",right:0,bottom:0,maxHeight:"100%"},Object(Oe.a)(t,e.breakpoints.up("xs"),{top:52}),Object(Oe.a)(t,e.breakpoints.up("sm"),{top:65}),Object(Oe.a)(t,e.breakpoints.up("md"),{top:65}),Object(Oe.a)(t,e.breakpoints.up("lg"),{top:65}),t)}})));var ze=function(e){var t=e.drawerBottom,a=e.setDrawerBottom,r=e.fileImageUrl,l=e.fileVideoUrl,i=e.setFileVideoUrl,s=e.setFileImageUrl,u=e.firebase,p=e.db,h=(e.storage,Qe()),E=m(),f=Object(c.a)(E,1)[0].user,g=Object(n.useState)(""),v=Object(c.a)(g,2),b=v[0],_=v[1],w=Object(d.h)().roomId;return o.a.createElement("div",null,o.a.createElement($.a,{variant:"persistent",anchor:"bottom",open:t,classes:{paper:h.drawerPaper,paperAnchorBottom:h.paperAnchorBottom}},o.a.createElement("div",{className:"drawerBottom__header"},o.a.createElement("div",{className:"drawerBottom__header_container"},o.a.createElement(k.a,{onClick:function(){a(!1)}},o.a.createElement(q.a,null)),o.a.createElement("p",null,"Preview"))),o.a.createElement("div",{className:"drawerBottom__content"},o.a.createElement("div",{className:"drawerBottom__content_photo"},r?o.a.createElement("img",{src:r,alt:""}):o.a.createElement("div",{className:"drawerBottom__content_video"},o.a.createElement("div",{className:"player-wrapper"},o.a.createElement(Me.a,{className:"react-player",width:"100%",height:"50%",url:l,controls:!0})))),o.a.createElement("div",{className:"drawerBottom__content_caption"},o.a.createElement("input",{type:"text",placeholder:"Add a caption...",value:b,onChange:function(e){return _(e.target.value)}}),o.a.createElement(Ge.a,{color:"primary","aria-label":"send",size:"large",onClick:function(e){e.preventDefault(),r&&(p.collection("rooms").doc(w).collection("messages").add({photo:r,name:f.displayName,uid:f.uid,caption:b,timestamp:u.firestore.FieldValue.serverTimestamp()}).then((function(e){p.collection("rooms").doc(w).collection("messages").doc(e.id).set({id:e.id},{merge:!0})})).catch((function(e){console.error("Error adding document: ",e)})),s(null)),l&&(p.collection("rooms").doc(w).collection("messages").add({video:l,name:f.displayName,uid:f.uid,caption:b,timestamp:u.firestore.FieldValue.serverTimestamp()}).then((function(e){p.collection("rooms").doc(w).collection("messages").doc(e.id).set({id:e.id},{merge:!0})})).catch((function(e){console.error("Error adding document: ",e)})),i(null)),_(""),a(!1)}},o.a.createElement("div",{className:"chat__icon"},o.a.createElement(Je.a,null))))),o.a.createElement("div",{className:"drawerBottom__footer"},o.a.createElement("div",null,r?o.a.createElement("img",{src:r,alt:""}):null))))},Ye=a(100),Ze=a(202),He=a(252),Ke=a(132),qe=a.n(Ke),Xe=a(134),$e=a.n(Xe),et=a(133),tt=a.n(et),at=a(129),nt=a.n(at),ot=a(131),rt=a.n(ot),lt=a(130),ct=a.n(lt),it=a(127),st=a.n(it),mt=a(128),ut=a.n(mt),dt=(a(196),a(197),[{title:"Room",icon:o.a.createElement(st.a,null),id:1e5*Math.random()},{title:"Contact",icon:o.a.createElement(ut.a,null),id:1e5*Math.random()},{title:"Document",icon:o.a.createElement(nt.a,null),id:1e5*Math.random()},{title:"Camera",icon:o.a.createElement(ct.a,null),id:1e5*Math.random()},{title:"Photos & Videos",icon:o.a.createElement(rt.a,null),id:1e5*Math.random()}]);var pt=function(e){var t=e.roomName,a=e.roomId,r=e.db,l=e.firebase,i=e.storage,s=m(),u=Object(c.a)(s,1)[0].user,d=Object(n.useState)(""),p=Object(c.a)(d,2),h=p[0],E=p[1],f=Object(n.useState)(!1),g=Object(c.a)(f,2),v=g[0],b=g[1],_=Object(n.useState)(null),y=Object(c.a)(_,2),O=y[0],j=y[1],A=Object(n.useState)(null),N=Object(c.a)(A,2),C=N[0],k=N[1],R=Object(n.useState)(!1),L=Object(c.a)(R,2),D=L[0],I=L[1],T=Object(n.useState)(!1),M=Object(c.a)(T,2),U=M[0],P=M[1],F=function(){w("All icons have the same functions, you can only upload images, gifs and videos!","attach","top-center"),P(!1===U)},B=function(e){var t=e.native;E(h+t)},V=function(){b(!1)},G=function(){var e=Object(Z.a)(Y.a.mark((function e(a){var n,o,r,l,c,s;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("fileSizeToastId",!((n=a.target.files[0]).size>12582912)){e.next=6;break}w("File should not exceed more than 12MB","fileSizeToastId","top-center"),e.next=32;break;case 6:if(o=i.ref(),!n.type.match("image.*")){e.next=20;break}return r=o.child("rooms/".concat(t,"/images/")),l=r.child((new Date).getTime()+" "+n.name),e.next=12,l.put(n);case 12:return e.t0=j,e.next=15,l.getDownloadURL();case 15:e.t1=e.sent,(0,e.t0)(e.t1),console.log("uploading image",O),e.next=31;break;case 20:if(!n.type.match("video.*")){e.next=31;break}return c=o.child("rooms/".concat(t,"/videos")),s=c.child((new Date).getTime()+" "+n.name),e.next=25,s.put(n);case 25:return e.t2=k,e.next=28,s.getDownloadURL();case 28:e.t3=e.sent,(0,e.t2)(e.t3),console.log("uploading video",C);case 31:I(!0);case 32:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return o.a.createElement("div",{className:"chat__footer"},o.a.createElement(ze,{drawerBottom:D,setDrawerBottom:I,fileVideoUrl:C,fileImageUrl:O,setFileImageUrl:j,setFileVideoUrl:k,roomId:a,db:r,firebase:l,storage:i}),v?o.a.createElement(De.a,{only:["xs"]},o.a.createElement(x,{name:"Close",icon:o.a.createElement(q.a,null),onClick:function(){return V()}})):null,o.a.createElement(x,{name:"Emoticons",icon:o.a.createElement(qe.a,null),onClick:function(){b(!0)}}),v?o.a.createElement(o.a.Fragment,null,o.a.createElement(De.a,{only:["xs"]},o.a.createElement(Ye.a,{onSelect:B})),o.a.createElement(De.a,{smUp:!0},o.a.createElement(He.a,{onClickAway:V},o.a.createElement(Ye.a,{onSelect:B})))):null,o.a.createElement("div",null,o.a.createElement(x,{name:"Attach",icon:o.a.createElement(tt.a,null),onClick:F}),U?o.a.createElement(He.a,{onClickAway:function(){P(!1)}},o.a.createElement("div",{className:"chat__attachFile"},dt.map((function(e){return o.a.createElement(Ze.a,{key:e.id,direction:"up",in:F,mountOnEnter:!0,unmountOnExit:!0},o.a.createElement(S.a,{title:o.a.createElement("span",{style:{fontSize:"14px",padding:"8px 5px 8px 5px"}},e.title),placement:"left"},o.a.createElement(Ge.a,{color:"primary","aria-label":"person"},o.a.createElement("div",{className:"chat__icon"},o.a.createElement("label",{htmlFor:"file-input"},e.icon),o.a.createElement("input",{id:"file-input",type:"file",onChange:G,accept:"image/*,video/mp4,video/3gpp,video/quicktime"})))))})))):null),o.a.createElement("form",null,o.a.createElement("textarea",{required:!0,value:h,onChange:function(e){return E(e.target.value)},placeholder:"Type a message",type:"text",rows:"1",onKeyDown:function(e){if(13===e.keyCode&&!1===e.shiftKey){e.preventDefault();a&&(/^((?:https?:)?\/\/)?((?:www|m)\.)?((?:youtube\.com|youtu.be))(\/(?:[\w\\-]+\?v=|embed\/|v\/)?)([\w\\-]+)(\S+)?$/.test(h)||/^https?:\/\/www\.facebook\.com.*\/(video(s)?|watch|story)(\.php?|\/).+$/.test(h)||/(http|https)?:\/\/(www\.|player\.)?vimeo\.com\/(?:channels\/(?:\w+\/)?|groups\/([^\\/]*)\/videos\/|video\/|)(\d+)(?:|\/\?)/.test(h)||/^https?:\/\/(soundcloud\.com|snd\.sc)\/(.*)$/.test(h)||/^.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/.test(h)?r.collection("rooms").doc(a).collection("messages").add({message:"",video:h,name:u.displayName,uid:u.uid,timestamp:l.firestore.FieldValue.serverTimestamp()}).then((function(e){console.log("Document written with ID: ",e.id),r.collection("rooms").doc(a).collection("messages").doc(e.id).set({id:e.id},{merge:!0})})).catch((function(e){console.error("Error adding document: ",e)})):/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\\.-]+)+[\w\-\\._~:/?#[\]@!\\$&'\\(\\)\\*\\+,;=.]+$/.test(h)?r.collection("rooms").doc(a).collection("messages").add({message:"",url:h,name:u.displayName,uid:u.uid,timestamp:l.firestore.FieldValue.serverTimestamp()}).then((function(e){console.log("Document written with ID: ",e.id),r.collection("rooms").doc(a).collection("messages").doc(e.id).set({id:e.id},{merge:!0})})).catch((function(e){console.error("Error adding document: ",e)})):/\S/.test(h)&&r.collection("rooms").doc(a).collection("messages").add({message:h,name:u.displayName,uid:u.uid,timestamp:l.firestore.FieldValue.serverTimestamp()}).then((function(e){r.collection("rooms").doc(a).collection("messages").doc(e.id).set({id:e.id},{merge:!0})})).catch((function(e){console.error("Error adding document: ",e)}))),E(""),b(!1)}}})),o.a.createElement(x,{name:"Voice Message",icon:o.a.createElement($e.a,null),onClick:function(){w("Voice Message is not yet available!","voiceMessage","top-center")}}))},ht=a(135),Et=a.n(ht);a(198);var ft=function(e){var t=e.showLandingScreenPhoto;return o.a.createElement("div",{className:"chat-landing-screen"},o.a.createElement("div",null,o.a.createElement(H.a,{in:t,style:{transitionDelay:t?"300ms":"0ms"}},o.a.createElement("img",{className:"chat-landing-screen__photo",src:"https://firebasestorage.googleapis.com/v0/b/tattle-9359.appspot.com/o/Folder%2Flogo.png?alt=media&token=21118386-5406-44a2-988e-0644a08c5b83",alt:"TattleLogo"}))),o.a.createElement("div",{className:"chat-landing-screen__title"},o.a.createElement("p",null,"Keeps you Connected")),o.a.createElement("div",null,o.a.createElement("p",null,"Tattle is driven by a fascination for mobile technology that was once viewed as a passing trend.")),o.a.createElement(Ne.a,null),o.a.createElement("div",{className:"chat-landing-screen__footer"},o.a.createElement(Et.a,null),o.a.createElement("p",null,"Tattle is available for Windows."),o.a.createElement("a",{target:"_blank",href:"https://tattle-9359.web.app",rel:"noopener noreferrer"},"Get it here.")))};a(116),a(199);var gt=function(e){var t=e.isRoomExist,a=Object(d.g)(),r=m(),l=Object(c.a)(r,1)[0].user,i=Object(d.h)().roomId,s=Object(n.useState)(""),u=Object(c.a)(s,2),h=u[0],E=u[1],f=Object(n.useState)(""),b=Object(c.a)(f,2),_=b[0],w=b[1],y=Object(n.useState)(""),O=Object(c.a)(y,2),j=O[0],A=O[1],N=Object(n.useState)(""),C=Object(c.a)(N,2),S=C[0],k=C[1],x=Object(n.useState)([]),R=Object(c.a)(x,2),L=R[0],D=R[1],I=Object(n.useState)(!1),T=Object(c.a)(I,2),M=T[0],U=T[1],P=Object(n.useState)(!1),F=Object(c.a)(P,2),B=F[0],V=F[1];return Object(n.useEffect)((function(){i?(v.collection("rooms").doc(i).onSnapshot((function(e){var t,a,n,o;w(null===(t=e.data())||void 0===t?void 0:t.name),A(null===(a=e.data())||void 0===a?void 0:a.createdBy),k(null===(n=e.data())||void 0===n?void 0:n.roomOwner),E(null===(o=e.data())||void 0===o?void 0:o.id)})),v.collection("rooms").doc(i).collection("messages").orderBy("timestamp","asc").onSnapshot((function(e){D(e.docs.map((function(e){return e.data()}))),U(!0)})),V(!1)):(V(!0),a.push("/"))}),[i,a]),o.a.createElement("div",{className:"chat"},i?o.a.createElement(o.a.Fragment,null,o.a.createElement("div",null,o.a.createElement(Ie,{roomCreatedBy:j,roomOwner:S,roomName:_,roomId:i,_roomId:h,messages:L,db:v,history:a,isRoomExist:t})),o.a.createElement("div",{className:"chat__body"},M?o.a.createElement(Ve,{roomCreatedBy:j,roomOwner:S,roomId:i,messages:L,user:l,isRoomExist:t}):o.a.createElement("div",{className:"chat__body_loading"},o.a.createElement("div",null,o.a.createElement(be.a,null)))),o.a.createElement("div",null,o.a.createElement(pt,{roomName:_,roomId:i,db:v,firebase:p.a,storage:g}))):o.a.createElement(ft,{showLandingScreenPhoto:B}))},vt=a(253);a(200);var bt=function(){var e=m(),t=Object(c.a)(e,2),a=t[0].user,r=t[1],l=Object(n.useState)([]),i=Object(c.a)(l,2),s=i[0],h=i[1],f=Object(n.useState)(""),g=Object(c.a)(f,2),y=g[0],O=g[1],j=Object(n.useState)(!1),N=Object(c.a)(j,2),C=N[0],S=N[1];return Object(n.useEffect)((function(){var e=E.onAuthStateChanged((function(e){if(e){if(r(b(e)),S(!0),v.collection("rooms").orderBy("timestamp","desc").onSnapshot((function(e){return h(e.docs.map((function(e){return{id:e.id,data:e.data()}})))})),!0===e.isAnonymous&&null===e.displayName){var t="Anonymous "+Math.floor(1e6*Math.random());E.currentUser.updateProfile({displayName:t,photoURL:""}),v.collection("users").doc(e.uid).set({name:t,about:"Hey there! I am using Tattle.",photoURL:"https://avatars.dicebear.com/api/human/ugtjh.svg",role:"anonymous",dateJoined:p.a.firestore.FieldValue.serverTimestamp()}).then((function(){console.log("Document successfully updated!")})).catch((function(e){console.error("Error updating document: ",e)}))}if(e.uid&&!1===e.isAnonymous&&null!==e.photoURL){v.collection("users").doc(e.uid).get().then((function(t){t.exists||v.collection("users").doc(e.uid).set({name:e.displayName,about:"Hey there! I am using Tattle.",photoURL:a.photoURL,role:"regular",dateJoined:p.a.firestore.FieldValue.serverTimestamp()})})).catch((function(e){w("".concat(e),"errorAbout","top-center")}))}else if(e.uid&&!1===e.isAnonymous&&null===e.photoURL){v.collection("users").doc(e.uid).get().then((function(t){t.exists?console.log("USER EXIST"):v.collection("users").doc(e.uid).set({name:e.displayName,about:"Hey there! I am using Tattle.",photoURL:"",role:"regular",dateJoined:p.a.firestore.FieldValue.serverTimestamp()})})).catch((function(e){w("".concat(e),"errorAbout","top-center")}))}}else r(b(null)),S(!0)}));return function(){e()}}),[r,a]),o.a.createElement("div",{className:"app ".concat(!1===C&&"app-no-bg")},C?o.a.createElement(o.a.Fragment,null,o.a.createElement(_.a,{position:"top-center",autoClose:5e3,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0}),a?o.a.createElement("div",{className:"app__body"},o.a.createElement(u.a,null,o.a.createElement(d.d,null,o.a.createElement(d.b,{exact:!0,path:"/"},o.a.createElement(ye,{rooms:s,setIsRoomExist:O,isRoomExist:y}),o.a.createElement(De.a,{only:["xs"]}," ",o.a.createElement(gt,{isRoomExist:y}))),o.a.createElement(d.b,{exact:!0,path:"/rooms/:roomId"},o.a.createElement(De.a,{only:["xs"]}," ",o.a.createElement(ye,{rooms:s,setIsRoomExist:O,isRoomExist:y})),o.a.createElement(gt,{isRoomExist:y})),o.a.createElement(d.b,{path:"*"},o.a.createElement(d.a,{to:"/"}))))):o.a.createElement(A,null)):o.a.createElement("div",{className:"app__loading"},o.a.createElement("div",null,o.a.createElement("div",{className:"app__loading_circular"},o.a.createElement(be.a,null)),o.a.createElement("div",{className:"app__loading_linear"},o.a.createElement(vt.a,null)))))},_t=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function wt(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var yt=a(99),Ot="SET_USER",jt=function(e,t){switch(t.type){case Ot:return Object(yt.a)(Object(yt.a)({},e),{},{user:t.user});default:return e}};l.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(s,{initialState:{user:null},reducer:jt},o.a.createElement(bt,null))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");_t?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):wt(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):wt(t,e)}))}}()}},[[201,1,2]]]);
//# sourceMappingURL=main.1b170010.chunk.js.map