(this.webpackJsonptattle=this.webpackJsonptattle||[]).push([[0],{268:function(e,t,a){},275:function(e,t,a){},278:function(e,t,a){},279:function(e,t,a){},280:function(e,t,a){},281:function(e,t,a){},286:function(e,t){},288:function(e,t){},298:function(e,t){},300:function(e,t){},327:function(e,t){},329:function(e,t){},330:function(e,t){},335:function(e,t){},337:function(e,t){},356:function(e,t){},368:function(e,t){},371:function(e,t){},398:function(e,t,a){},399:function(e,t,a){},400:function(e,t,a){},401:function(e,t,a){},402:function(e,t,a){},420:function(e,t,a){},421:function(e,t,a){},424:function(e,t,a){},425:function(e,t,a){},426:function(e,t,a){},427:function(e,t,a){},428:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(17),c=a.n(r),l=(a(268),a(7)),i=Object(n.createContext)(),s=function(e){var t=e.reducer,a=e.initialState,r=e.children;return o.a.createElement(i.Provider,{value:Object(n.useReducer)(t,a)},r)},m=function(){return Object(n.useContext)(i)},u=a(56),d=a(28),p=a(85),h=p.a.initializeApp({apiKey:"AIzaSyCF7lHw_Z7DmZgpoZuYIGveD0eZ8ha7Qyg",authDomain:"tattle-9359.firebaseapp.com",databaseURL:"https://tattle-9359-default-rtdb.firebaseio.com/",projectId:"tattle-9359",storageBucket:"tattle-9359.appspot.com",messagingSenderId:"849640668400",appId:"1:849640668400:web:91c77b3a931a325ef4d635",measurementId:"G-17X1MHRTRX"}).firestore(),f=p.a.auth(),E=new p.a.auth.GoogleAuthProvider,g=p.a.storage(),v=h;function b(e){return{type:"SET_USER",user:e}}var _=a(107),y=function(e,t,a){_.b.info(e,{toastId:t,position:a,autoClose:5e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})},w=a(224),O=a.n(w),j=a.p+"static/media/logo.179025b4.webp";a(275);var S=function(){return o.a.createElement("div",{className:"login"},o.a.createElement("div",{className:"login__container"},o.a.createElement("img",{rel:"preload",src:j,alt:"Tattle Logo"}),o.a.createElement("div",{className:"login__text"},o.a.createElement("h2",null,"Keeps you Connected"),o.a.createElement("br",null),o.a.createElement("p",null,"Tattle is driven by a fascination for communication "),o.a.createElement("p",null,"technology that was once viewed as a passing trend.")),o.a.createElement("div",{className:"login__withGoogle",onClick:function(){f.signInWithPopup(E).catch((function(e){return y("".concat(e),"google","top-center")}))}},o.a.createElement("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAD8klEQVRogc2aW6iUVRTHf845apiXY4lgFlYoSealSMuQiiwjQkEsIqjH6CUIeu/NehAEC8Oi7EoUeSLJk90IAi8pFlREF1SiOtWb1vFW56j/WLUmpmkG197f983MHzYzD/vy/3/7svZaa4+TRAmYAlwOLASWAvOAS4DpwGTgLHAcOAoMA4eAfcDX/v9EUQpFhVwP3AGs8v852AN8AOwEPs1mYkIyymJJr0o6ofIwIulNSStzOKU2mC1pq6SjJQpoxilJL0m6qCohd0n6vkIBzfhR0v1lCpkg6ckOCmjGYxEh/efYQnbivAyszd6ExXAQ2Ft0s0+WNNTFmdgpaU7RpTVe0ntdFLFZUl8Zm31DlwSMSXok5/htZRDvAV7PXNmjwLfALrfcPwNH3LIPAHOAZcCNwHxgYkNbq/sA8G7WyE3KZkgazvyS29yYjQt8Qatzi6Ttkv6Q9KWkq3Jmot3SejpDxO5ca+zlJkkzi4hoFrJc0miiiGckTSpKooxSa1hlDwPjE1bleuBB4GTWmi4b/jUWSvo9cSa6PguNpT4jZrmnBr/RF8BDPTELDaj5EXh7sP6YixjrCLsEmJC5wHXBJub87O4J5k0wIUuAvkDdY8CmjrJLgN1+FwWrfwd8nDnOav6x2lVhyIQsCHZ+oACJJS6mKky1pTU72PknBUiMVCjCMFBLOHaHKyZTBNNNyLRg5SNVsymA801INLA12pMSHCbkt2DdgcrZ5GOk5vYhgst6XcgvwcrXFBgo5Vadgx9MyFfBhisLDFS/mylYzDU+5b8RHOr322wEi1zMRxlC3gIOA38G659xv/7RYP3P7S6/QNKZoB+yo4M+xvNBTsb9SmswUdKuYCNzhVd0QMQKD2hEsN/c7ZpP9/vBKbRN+1TFm/c8YLNfaCPYYe523UN8O+E+ZHtlSzUa/oa5CouDdY859/9EUV4LTmUdj1ewpDYmcthWb9vYyfLETgzPlhQOmiJpS8b4N7QSYuW5jM4sQHdbARG3StqXMe6Ljf00d3qhZ4pScVrSoKRViSHTQW+bil89Dfhvn62C2HcDb2RuVLPg33iAYj/wU0MQ21LVl3r62ozdFU1B7BTc+79Ae5sv1q20QgSbWnFul2e3M3w7cGfmF6sKlo9f0+qqU2sz4GnPkwz1mIh17e5r7YTgzypsLQ5Wxy2Md5zL8bYNAidMn6/LbuEJSf3n4ply3q+TdLiDYswM3Bfll2q8Zvn1uuonHC/4WGFuudbYHtW8UrIgy88M5qbxij5zutq9Rjumb87sw4znh76hP8slUtbDM/MhzFLbw7Nr/eHZxcAF/gzEBrETx6y8RSztaYZZ/vrDs2LpO+AvpvyKMZBkRBsAAAAASUVORK5CYII=",alt:"Google Logo"}),o.a.createElement("span",null,"Sign in with Google")),o.a.createElement("div",{className:"login__withGoogle login__Anonymously",onClick:function(){f.signInAnonymously().catch((function(e){return y("".concat(e),"anonymous","top-center")}))}},o.a.createElement(O.a,null),o.a.createElement("span",null,"Login Anonymously"))))},N=a(484);var C=function(e){var t=e.photoURL,a=e.onClick;return o.a.createElement("div",{style:{cursor:"pointer"}},o.a.createElement(N.a,{src:t,onClick:a}))},k=a(483),x=a(468);var A=function(e){var t=e.name,a=e.icon,n=e.onClick;return o.a.createElement("div",null,o.a.createElement(k.a,{title:o.a.createElement("span",{style:{fontSize:"14px",padding:"8px 5px 8px 5px"}},t),placement:"bottom-end"},o.a.createElement(x.a,{onClick:n},a)))},L=a(472),R=a(481),U=a(469),D=a(471),F=a(470),I=a(485),M=a(226),T=a.n(M);var P=function(e){var t=e.user,a=e.db,r=e.firebase,c=Object(n.useState)(""),i=Object(l.a)(c,2),s=i[0],m=i[1],u=Object(n.useState)(!1),d=Object(l.a)(u,2),p=d[0],h=d[1],f=function(){h(!1),m("")};return o.a.createElement("div",null,o.a.createElement(A,{name:"New Chat",onClick:function(){h(!0)},icon:o.a.createElement(T.a,{style:{color:"#de5751"}})}),o.a.createElement(U.a,{open:p,onClose:f,"aria-labelledby":"form-dialog-title"},o.a.createElement(I.a,{id:"form-dialog-title"},"Create Chat Room"),o.a.createElement(F.a,null,o.a.createElement(R.a,{autoFocus:!0,margin:"dense",id:"name",label:"Room Name",type:"text",fullWidth:!0,value:s,onChange:function(e){return m(e.target.value)}})),o.a.createElement(D.a,null,o.a.createElement(L.a,{onClick:f,color:"primary"},"Cancel"),o.a.createElement(L.a,{onClick:function(e){e.preventDefault(),s&&a.collection("rooms").add({roomOwner:t.uid,createdBy:t.displayName,name:s,timestamp:r.firestore.FieldValue.serverTimestamp()}).then((function(e){a.collection("rooms").doc(e.id).set({id:e.id},{merge:!0})})).catch((function(e){console.error("Error adding document: ",e)})),h(!1),m("")},color:"primary",disabled:!s},"Create"))))},B=a(227),z=a.n(B);var Y=function(){return o.a.createElement("div",null,o.a.createElement(A,{name:"Status",icon:o.a.createElement(z.a,{style:{color:"#de5751"}})}))},V=a(246),H=a(486);var W=function(e){var t=e.menuLists,a=e.menu,n=e.handleMenuClose;return o.a.createElement("div",null,o.a.createElement(V.a,{id:"simple-menu",anchorEl:a,keepMounted:!0,open:Boolean(a),onClose:n,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},getContentAnchorEl:null},t.map((function(e){return o.a.createElement(H.a,{key:e.id,onClick:e.onClick},e.title)}))))},G=a(84),Z=a.n(G),Q=a(115),J=a(473),K=a(53),q=a.n(K);a(278);var X=function(e){var t=e.open,a=e.close,n=e.user,r=e.photo;return o.a.createElement(U.a,{open:t,fullScreen:!0,onClose:a,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},o.a.createElement(I.a,{id:"alert-dialog-title-dialogCustom"},o.a.createElement("div",null,o.a.createElement(N.a,{src:n.photoURL})),o.a.createElement("div",null,o.a.createElement(x.a,{edge:"end",color:"inherit",onClick:a,"aria-label":"close"},o.a.createElement(q.a,null)))),o.a.createElement(F.a,null,o.a.createElement(J.a,{in:t,style:{transitionDelay:t?"300ms":"0ms"}},o.a.createElement("img",{src:r,alt:"",className:"DialogCustom__photo"}))))},$=a(475),ee=a(474),te=a(77),ae=a.n(te),ne=a(116),oe=a.n(ne),re=a(149),ce=a.n(re),le=a(122),ie=a.n(le),se=(a(279),Object(ee.a)((function(e){return{root:{display:"flex"},drawerPaper:{position:"absolute"}}})));var me=function(e){var t=e.drawerLeft,a=e.setDrawerLeft,r=e.db,c=e.auth,i=e.storage,s=se(),u=m(),d=Object(l.a)(u,1)[0].user,p=Object(n.useState)(""),h=Object(l.a)(p,2),f=h[0],E=h[1],g=Object(n.useState)(""),v=Object(l.a)(g,2),b=v[0],_=v[1],w=Object(n.useState)(!1),O=Object(l.a)(w,2),j=O[0],S=O[1],C=Object(n.useState)(!1),k=Object(l.a)(C,2),A=k[0],L=k[1],R=Object(n.useState)(!1),M=Object(l.a)(R,2),T=M[0],P=M[1],B=Object(n.useState)(null),z=Object(l.a)(B,2),Y=z[0],V=z[1],H=Object(n.useState)(!1),G=Object(l.a)(H,2),K=G[0],q=G[1],ee=Object(n.useState)(null),te=Object(l.a)(ee,2),ne=te[0],re=te[1],le=Object(n.useState)(""),me=Object(l.a)(le,2),ue=me[0],de=me[1];Object(n.useEffect)((function(){E(d.displayName),r.collection("users").doc(d.uid).onSnapshot((function(e){var t,a;de(null===(t=e.data())||void 0===t?void 0:t.photoURL),_(null===(a=e.data())||void 0===a?void 0:a.about)}))}),[d.uid,d.displayName,r]);var pe=function(){var e=Object(Q.a)(Z.a.mark((function e(t){var a,n,o,r,c,l;return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("imageFileSizeToastId",!((a=t.target.files[0]).size>3145728)){e.next=6;break}y("Image should not exceed more than 3Mb","imageFileSizeToastId","top-center"),e.next=30;break;case 6:if(n=i.ref(),!0!==d.isAnonymous){e.next=20;break}return o=n.child("user/anonymous/".concat(d.uid)),r=o.child(a.name),e.next=12,r.put(a);case 12:return e.t0=V,e.next=15,r.getDownloadURL();case 15:e.t1=e.sent,(0,e.t0)(e.t1),console.log("uploading image",Y),e.next=30;break;case 20:return c=n.child("user/regular/".concat(d.uid)),l=c.child(a.name),e.next=24,l.put(a);case 24:return e.t2=V,e.next=27,l.getDownloadURL();case 27:e.t3=e.sent,(0,e.t2)(e.t3),console.log("uploading image",Y);case 30:re(null),q(!0);case 32:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),he=function(){Y?(c.currentUser.updateProfile({photoURL:Y}),r.collection("users").doc(d.uid).set({photoURL:Y},{merge:!0}),q(!1)):y("Select photo to upload!","uploadPhotoError","top-center")},fe=[{title:"View Photo",onClick:function(){return d?P(!0):y("You have no photo!","viewPhoto","top-center"),void re(null)},id:1e5*Math.random()},{title:"Take photo",onClick:function(){y("Take photo is not yet available!","takePhoto","top-center")},id:1e5*Math.random()},{title:o.a.createElement("div",{className:"profileMenu_uploadPhoto"},o.a.createElement("label",{htmlFor:"file-input"},"Upload photo"),o.a.createElement("input",{id:"file-input",type:"file",onChange:pe,accept:"image/*"})),onClick:function(){return he()},id:1e5*Math.random()},{title:"Removed photo",onClick:function(){y("Removed photo is not yet available!","removedPhoto","top-center")},id:1e5*Math.random()}];return o.a.createElement("div",null,o.a.createElement($.a,{anchor:"left",variant:"persistent",open:t,classes:{paper:s.drawerPaper}},o.a.createElement("div",{className:"drawerLeft__header"},o.a.createElement("div",{className:"drawerLeft__header_container"},o.a.createElement(x.a,{onClick:function(){a(!1),S(!1),L(!1)}},o.a.createElement(oe.a,null)),o.a.createElement("p",null,"Profile"))),o.a.createElement("div",{className:"drawerLeft__content"},o.a.createElement("div",{className:"drawerLeft__content_photo"},o.a.createElement("div",{className:"profilePhoto"},o.a.createElement(J.a,{in:t,style:{transitionDelay:t?"300ms":"0ms"}},ue?o.a.createElement(N.a,{src:ue,className:"profilePhoto__layer_bottom"}):o.a.createElement(N.a,null)),o.a.createElement("div",{className:"profilePhoto__layer_top",onClick:function(e){re(e.currentTarget)}},o.a.createElement("div",{className:"profilePhoto__text"},o.a.createElement(ae.a,null),o.a.createElement("p",null,"CHANGE"),o.a.createElement("p",null,"PROFILE PHOTO")))),o.a.createElement(W,{menuLists:fe,menu:ne,handleMenuClose:function(){re(null)}}),o.a.createElement(X,{open:T,close:function(){P(!1)},photo:ue,user:d})),o.a.createElement("div",{className:"profileMenu__diaglog"},o.a.createElement(U.a,{open:K,onClose:function(){q(!1)},"aria-labelledby":"form-dialog-title"},o.a.createElement(I.a,{id:"form-dialog-title-drawerLeft"},"Upload Photo"),o.a.createElement(F.a,{id:"form-dialog-content"},o.a.createElement("div",{className:"profileMenu__uploadPhoto_dialog"},o.a.createElement("img",{src:Y,alt:""}))),o.a.createElement(D.a,null,o.a.createElement("div",{className:"profileMenu_uploadPhoto_iconButton"},o.a.createElement(x.a,{onClick:he},o.a.createElement(ie.a,null)))))),o.a.createElement("div",{className:"drawerLeft__content_name"},o.a.createElement("p",null,"Your Name"),o.a.createElement("form",null,j?o.a.createElement(o.a.Fragment,null,o.a.createElement("input",{value:f,onChange:function(e){return E(e.target.value)},type:"text",styles:{borderBottom:"1px solid green !important"}}),o.a.createElement(ie.a,{onClick:function(e){e.preventDefault(),d.uid&&(r.collection("users").doc(d.uid).update({name:f}).then((function(){console.log("Document successfully updated!")})).catch((function(e){console.error("Error updating document: ",e)})),c.currentUser.updateProfile({displayName:f})),S(!1)}})):o.a.createElement(o.a.Fragment,null,o.a.createElement("span",null,f),o.a.createElement(ce.a,{onClick:function(){S(!0)}})))),o.a.createElement("div",{className:"drawerLeft__note"},o.a.createElement("span",null,"This is not your username or pin. This name will be visible to your Tattle contacts.")),o.a.createElement("div",{className:"drawerLeft__content_name"},o.a.createElement("p",null,"About"),o.a.createElement("form",null,A?o.a.createElement(o.a.Fragment,null,o.a.createElement("input",{value:b,onChange:function(e){return _(e.target.value)},type:"text"}),o.a.createElement(ie.a,{onClick:function(e){e.preventDefault(),d.uid&&r.collection("users").doc(d.uid).update({about:b}).then((function(){console.log("Document successfully updated!")})).catch((function(e){console.error("Error updating document: ",e)})),L(!1)}})):o.a.createElement(o.a.Fragment,null,o.a.createElement("span",null,b),o.a.createElement(ce.a,{onClick:function(){L(!0)}})))))))},ue=a(117),de=a.n(ue),pe=a(228),he=a.n(pe);a(280);var fe=function(e){var t=e.placeholder,a=e.setSearch,r=e.search,c=Object(n.useState)(!1),i=Object(l.a)(c,2),s=i[0],m=i[1];return o.a.createElement("div",{className:"search ".concat(!0===s&&"search__bgColorChange")},o.a.createElement("div",{className:"search__container"},o.a.createElement("span",{className:"".concat(!0===s?"arroww":"")},s?o.a.createElement(he.a,null):o.a.createElement(de.a,null)),o.a.createElement("input",{value:r,onChange:function(e){return a(e.target.value)},type:"text",placeholder:t,required:!0,onFocus:function(){m(!0)},onBlur:function(){m(!1)}})))},Ee=a(229),ge=a.n(Ee),ve=(a(281),a(95));var be=function(e){var t,a,r,c,i,s=e.id,m=e.name,d=Object(n.useState)([]),p=Object(l.a)(d,2),h=p[0],f=p[1];return Object(n.useEffect)((function(){s&&v.collection("rooms").doc(s).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){return f(e.docs.map((function(e){return e.data()})))}))}),[s]),o.a.createElement(u.b,{to:"/rooms/".concat(s),className:"sidebarChat__link"},o.a.createElement("div",{className:"sidebarChat"},o.a.createElement(N.a,null,m[0]),o.a.createElement("div",{className:"sidebarChat__info"},o.a.createElement("h2",null,m),(null===(t=h[0])||void 0===t?void 0:t.photo)?o.a.createElement("div",{className:"sideChat__photo"},o.a.createElement(ae.a,null)," ",o.a.createElement("span",null,"Photo")):null,(null===(a=h[0])||void 0===a?void 0:a.video)?o.a.createElement("div",{className:"sideChat__photo"},o.a.createElement(ge.a,null)," ",o.a.createElement("span",null,"Video")):null,o.a.createElement("p",null,(null===(r=h[0])||void 0===r?void 0:r.message)?function(e){var t=ve.AES.decrypt(e,"my-secret-key@123").toString(ve.enc.Utf8);return e?t:e}(null===(c=h[0])||void 0===c?void 0:c.message):""),o.a.createElement("p",null,null===(i=h[0])||void 0===i?void 0:i.url))))},_e=a(476),ye=a(118),we=a.n(ye);a(398);var Oe=function(e){var t=e.rooms,a=e.setIsRoomExist,r=e.isRoomExist,c=Object(d.g)(),i=Object(d.h)().roomId,s=m(),u=Object(l.a)(s,1)[0].user,h=Object(n.useState)(""),E=Object(l.a)(h,2),b=E[0],_=E[1],w=Object(n.useState)(!1),O=Object(l.a)(w,2),j=O[0],S=O[1],N=Object(n.useState)(!1),k=Object(l.a)(N,2),x=k[0],L=k[1],R=Object(n.useState)(!1),U=Object(l.a)(R,2),D=U[0],F=U[1],I=Object(n.useState)(null),M=Object(l.a)(I,2),T=M[0],B=M[1],z=Object(n.useState)(!1),V=Object(l.a)(z,2),H=V[0],G=V[1],Z=function(e){return function(t){return(t.data.name+"").toLowerCase().includes(e.toLowerCase())||!e}};Object(n.useEffect)((function(){b&&(o.a.createElement(o.a.Fragment,null,t.filter(Z(b)).map((function(e){return o.a.createElement("p",{key:e.id},e.name)}))).props.children.length>0?G(!0):G(!1));if(t){var e=t.findIndex((function(e,t){return e.id===i}));e>=0?a(e):-1===e&&(a(e),c.push("/"))}}),[b,t,i,c,a]),Object(n.useEffect)((function(){t&&(t.length>0?(L(!1),S(!0)):0===t.length&&-1===r&&(L(!0),S(!0)))}),[r,t]);var Q=function(){B(null),F(!0)},J=function(e){B(e.currentTarget)},K=[{title:"Profile",onClick:function(){return Q()},id:1e5*Math.random()},{title:"Archived",onClick:function(){y("Archive is not yet available!","archive","top-center")},id:1e5*Math.random()},{title:"Starred",onClick:function(){y("Starred is not yet available!","starred","top-center")},id:1e5*Math.random()},{title:"Settings",onClick:function(){y("Settings is not yet available!","settings","top-center")},id:1e5*Math.random()},{title:"Logout",onClick:function(){!0===u.isAnonymous?f.currentUser.delete().then((function(){c.push("/")})).catch((function(e){console.log("error deleting anonymous user",e)})):f.signOut()},id:1e5*Math.random()}];return o.a.createElement("div",{className:"sidebar"},o.a.createElement("div",{className:"sidebar__header"},o.a.createElement(C,{id:"UserProfile",photoURL:u.photoURL,onClick:function(){return Q()}}),o.a.createElement(me,{drawerLeft:D,setDrawerLeft:F,db:v,auth:f,storage:g}),o.a.createElement("div",{className:"sidebar__headerRight"},o.a.createElement(Y,null),o.a.createElement(P,{db:v,user:u,firebase:p.a}),o.a.createElement(A,{name:"Menu",icon:o.a.createElement(we.a,{style:{color:"#de5751"}}),onClick:J}),o.a.createElement(W,{menuLists:K,menu:T,handleMenuOpen:J,handleMenuClose:function(){B(null)}}))),o.a.createElement(fe,{search:b,setSearch:_,placeholder:"Search or start new chat"}),o.a.createElement("div",{className:"sidebar__chats"},j?o.a.createElement(o.a.Fragment,null,b?o.a.createElement(o.a.Fragment,null,H?o.a.createElement("div",null,t.filter(Z(b)).map((function(e){return o.a.createElement(be,{key:e.id,id:e.id,name:e.data.name})}))):o.a.createElement("div",{className:"sidebar__chatsContainer_empty"},o.a.createElement("span",null,"No chat room found"))):o.a.createElement(o.a.Fragment,null,t.map((function(e){return o.a.createElement(be,{key:e.id,id:e.id,name:e.data.name})})))):o.a.createElement("div",{className:"sidebar__chatsContainer_loading"},o.a.createElement("div",null,o.a.createElement(_e.a,null))),x&&j?o.a.createElement("div",{className:"sidebar__chatsContainer_empty"},o.a.createElement("span",null,"No chats")):null))},je=a(15),Se=(a(399),Object(ee.a)((function(e){var t;return{root:{display:"flex"},drawerPaper:(t={},Object(je.a)(t,e.breakpoints.only("xs"),{width:"100vw"}),Object(je.a)(t,e.breakpoints.up("sm"),{position:"absolute"}),t)}})));var Ne=function(e){var t=e.content,a=e.drawerRight,n=Se();return o.a.createElement("div",null,o.a.createElement($.a,{anchor:"right",variant:"persistent",open:a,classes:{paper:n.drawerPaper}},t))},Ce=a(477),ke=a(119),xe=a.n(ke),Ae=(a(400),a(95));var Le=function(e){var t=e.drawerRightSearch,a=e.setDrawerRightSearch,r=e.messages,c=e.user,i=Object(n.useState)(""),s=Object(l.a)(i,2),m=s[0],u=s[1],d=Object(n.useState)(!1),p=Object(l.a)(d,2),h=p[0],f=p[1],E=function(e){return function(t){return(t.message+""+t.caption).toLowerCase().includes(e.toLowerCase())||!e}},g=function(e){var t=Ae.AES.decrypt(e,"my-secret-key@123").toString(Ae.enc.Utf8);return e?t:e};return Object(n.useEffect)((function(){m&&(o.a.createElement(o.a.Fragment,null,r.filter(E(m)).map((function(e){return o.a.createElement("p",{key:e.id},e.message?g(e.message):"",e.caption)}))).props.children.length>0?(f(!0),console.log("search message sucess")):(f(!1),console.log("search message fail")))}),[m,r]),o.a.createElement("div",null,o.a.createElement(Ne,{drawerRight:t,content:o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"drawerRight__header"},o.a.createElement(x.a,{onClick:function(){a(!1)}},o.a.createElement(q.a,null)),o.a.createElement("p",null,"Search Messages")),o.a.createElement(fe,{search:m,setSearch:u,placeholder:"Search..."}),o.a.createElement("div",{className:"drawerRight__content ".concat(!0===h&&m.length>0&&"drawerRight__content_searched")},m.length>0?o.a.createElement(o.a.Fragment,null,h?o.a.createElement(o.a.Fragment,null,r.filter(E(m)).map((function(e){var t;return o.a.createElement("div",{key:e.id,className:"drawerRight__content_searched_message"},o.a.createElement("p",null,new Date(null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toLocaleTimeString("en-US",{hour:"numeric",hour12:!0,minute:"numeric"}),o.a.createElement("br",null)),o.a.createElement("p",{id:"last_p"},e.uid===c.uid?o.a.createElement(xe.a,null):null,e.message?g(e.message):"",e.caption),o.a.createElement(Ce.a,null))}))):o.a.createElement("p",null,"No message found")):o.a.createElement("p",null,"Search for messages in this room.")))}))},Re=a(230),Ue=a.n(Re);a(401);var De=function(e){var t=e.drawerRightInfo,a=e.setDrawerRightInfo,r=e.messages,c=(e.user,Object(n.useState)("")),i=Object(l.a)(c,2),s=i[0],m=(i[1],Object(n.useState)(!1)),u=Object(l.a)(m,2),d=(u[0],u[1]);return Object(n.useEffect)((function(){s&&(function(){return o.a.createElement(o.a.Fragment,null,r.filter((e=s,function(t){return(t.message+""+t.caption).toLowerCase().includes(e.toLowerCase())||!e})).map((function(e){return o.a.createElement("p",{key:e.id},e.message,e.caption)})));var e}().props.children.length>0?(d(!0),console.log("search message sucess")):(d(!1),console.log("search message fail")))}),[s,r]),o.a.createElement("div",null,o.a.createElement(Ne,{drawerRight:t,content:o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"drawer-right-info__header"},o.a.createElement(x.a,{onClick:function(){a(!1)}},o.a.createElement(q.a,null)),o.a.createElement("p",null,"Group Info")),o.a.createElement("div",{className:"drawer-right-info-content"},o.a.createElement("div",{className:"drawer-right-info-content__photo"},o.a.createElement("div",{className:"profilePhoto"},o.a.createElement(J.a,{in:t,style:{transitionDelay:t?"300ms":"0ms"}},o.a.createElement(N.a,null,o.a.createElement(Ue.a,null))),o.a.createElement("div",{className:"profilePhoto__layer_top"},o.a.createElement("div",{className:"profilePhoto__text"},o.a.createElement(ae.a,null),o.a.createElement("p",null,"CHANGE"),o.a.createElement("p",null,"PROFILE PHOTO")))))))}))},Fe=a(482);a(402);var Ie=function(e){var t=e.roomCreatedBy,a=e.roomOwner,r=e.roomName,c=e.roomId,i=(e._roomId,e.messages),s=e.db,d=e.history,p=e.isRoomExist,h=m(),f=Object(l.a)(h,1)[0].user,E=Object(n.useState)(!1),g=Object(l.a)(E,2),v=g[0],b=g[1],_=Object(n.useState)(!1),w=Object(l.a)(_,2),O=w[0],j=w[1],S=Object(n.useState)(null),C=Object(l.a)(S,2),k=C[0],L=C[1],R=Object(n.useState)(""),U=Object(l.a)(R,2),D=U[0],F=U[1],I=Object(n.useState)(!1),M=Object(l.a)(I,2),T=M[0],P=M[1],B=Object(n.useState)(!1),z=Object(l.a)(B,2),Y=z[0],V=z[1];Object(n.useEffect)((function(){var e;f.uid&&s.collection("users").doc(f.uid).get().then((function(e){e.exists&&F(e.data().role)})).catch((function(e){y("".concat(e),"errorAbout","top-center")})),(null===(e=i[i.length-1])||void 0===e?void 0:e.timestamp)?P(!0):P(!1),i[i.length-1]?V(!0):V(!1),p>=0&&(j(!1),b(!1))}),[f.uid,f.displayName,f.isAnonymous,s,i,c,p]);var H=function(e){L(e.currentTarget)},G=[{title:"Contact info",onClick:function(){return j(!0),void L(null)},id:1e5*Math.random()},{title:"Select messages",onClick:function(){y("Select Messages is not yet  available!","selectMessages","top-center")},id:1e5*Math.random()},{title:"Mute notifications",onClick:function(){y("Mute Notifications is not yet available!","muteNotifications","top-center")},id:1e5*Math.random()},{title:"Clear messages",onClick:function(){y("Clear Messages is not yet available!","clearMessages","top-center")},id:1e5*Math.random()},{title:"Delete Room",onClick:function(){return function(){var e="roomDeleted";a===f.uid||"admin"===D?(s.collection("rooms").doc(c).delete().then((function(){y("Room successfully deleted!",e,"top-center")})).catch((function(t){y("Error removing room! ".concat(t),e,"top-center")})),d.push("/")):y("You are not allowed to delete room ".concat(r,". Only the admin or room owner ").concat(t),e,"top-center")}()},id:1e5*Math.random()}];return o.a.createElement("div",{className:"chat__header"},o.a.createElement(Le,{drawerRightSearch:v,setDrawerRightSearch:b,roomId:c,messages:i,db:s,user:f}),o.a.createElement(De,{drawerRightInfo:O,setDrawerRightInfo:j,roomId:c,messages:i,db:s,user:f}),o.a.createElement(Fe.a,{smUp:!0},o.a.createElement(u.b,{to:"/"},o.a.createElement("div",{className:"chat__back_button"},o.a.createElement(x.a,null,o.a.createElement(oe.a,{style:{color:"#de5751"}}))))),o.a.createElement(N.a,null,r[0]),o.a.createElement("div",{className:"chat__headerInfo"},o.a.createElement("h3",null,r),Y?o.a.createElement(o.a.Fragment,null,T?o.a.createElement("p",null,"Last seen ",function(){var e,t;return new Date(null===(e=i[i.length-1])||void 0===e||null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toLocaleTimeString([],{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",hour12:!0,minute:"numeric"})}()):o.a.createElement("p",null,"Last seen ",(new Date).toLocaleTimeString([],{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",hour12:!0,minute:"numeric"}))):null),o.a.createElement("div",{className:"chat__headerRight"},o.a.createElement(A,{name:"Search",icon:o.a.createElement(de.a,{style:{color:"#de5751"}}),onClick:function(){b(!0)}}),o.a.createElement(A,{name:"Menu",icon:o.a.createElement(we.a,{style:{color:"#de5751"}}),onClick:H}),o.a.createElement(W,{menuLists:G,menu:k,handleMenuOpen:H,handleMenuClose:function(){L(null)}})))},Me=a(120),Te=a.n(Me),Pe=a(231),Be=a.n(Pe),ze=a(232),Ye=a.n(ze),Ve=(a(420),a(95));var He=function(e){var t=e.roomOwner,a=e.roomCreatedBy,r=e.messages,c=e.user,i=e.roomId,s=e.isRoomExist,m=Object(n.useRef)(null),u=Object(n.useState)(!1),d=Object(l.a)(u,2),p=d[0],h=d[1];Object(n.useEffect)((function(){s>=0&&h(!1)}),[s]);var f=function(){h(!0)},E=function(){h(!1)};return Object(n.useEffect)((function(){i&&m.current.scrollIntoView({behavior:"auto"})}),[r,i]),o.a.createElement("div",null,o.a.createElement("p",{className:"chat__message_reminder"},o.a.createElement(Be.a,null)," Welcome to Tattle. Messages are encrpyted."),o.a.createElement("p",{className:"chat__message_reminder chat__createdBy"},t===c.uid?"You created this group":"".concat(a," created this group")),r.map((function(e){return o.a.createElement("div",{key:e.id,className:"chat__message \n                    ".concat(e.uid===c.uid&&"chat__sender"," \n                    ").concat(e.photo&&"chat__message_media_image","\n                    ").concat(e.video&&"chat__message_media_video","\n                    ").concat(e.video&&!e.caption&&"chat__message_media_video_noCaption"," ")},o.a.createElement("span",{className:"chat__name ".concat(e.uid===c.uid&&"chat__name_sender")},e.name),o.a.createElement("div",{className:"chat__body_image_container"},e.photo?o.a.createElement(o.a.Fragment,null,o.a.createElement("img",{alt:"",className:"chat__body_image",src:e.photo})):null),o.a.createElement("div",{className:"chat__body_video_container"},e.video?o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"player-wrapper"},o.a.createElement(Te.a,{className:"react-player",width:"100%",height:"100%",url:e.video,controls:!0,onPlay:f,onPause:E,onEnded:E}))):null),o.a.createElement("div",{className:"chat__message_box"},o.a.createElement("div",{className:"chat__message_box_text ".concat(e.uid===c.uid&&"chat__message_box_text_sender","\n              ").concat(e.photo&&!e.caption&&"chat__message_box_text_no_caption"," ")},e.message?function(e){var t=Ve.AES.decrypt(e,"my-secret-key@123").toString(Ve.enc.Utf8);return e?t:e}(e.message):null,e.caption?e.caption:null,e.url?o.a.createElement("a",{target:"_blank",href:"".concat(e.url),rel:"noopener noreferrer"},e.url):null,o.a.createElement("div",{className:"chat__timestamp_container ".concat(e.uid===c.uid&&"chat__timestamp_container_sender")},e.timestamp?o.a.createElement("div",{className:"chat__timestamp \n                                    ".concat(e.photo&&!e.caption&&"chat__timestamp_media_photo","  \n                                    ").concat(e.video&&!e.caption&&"chat__timestamp_media_video","\n                                    ").concat(e.video&&!e.caption&&!0===p&&"chat__timestamp_media_displayNone")},o.a.createElement("span",null,new Date(e.timestamp.toDate()).toLocaleTimeString("en-US",{hour:"numeric",hour12:!0,minute:"numeric"}),e.uid===c.uid?o.a.createElement(xe.a,null):null)):o.a.createElement("div",{className:"chat__timestamp"},o.a.createElement("span",null,(new Date).toLocaleTimeString("en-US",{hour:"numeric",hour12:!0,minute:"numeric"}),e.uid===c.uid?o.a.createElement(Ye.a,null):null))))))})),o.a.createElement("div",{ref:m}))},We=a(478),Ge=a(121),Ze=a.n(Ge),Qe=(a(421),Object(ee.a)((function(e){var t;return{root:{display:"flex"},drawerPaper:{position:"absolute",width:"100%"},paperAnchorBottom:(t={left:"auto",right:0,bottom:0,maxHeight:"100%"},Object(je.a)(t,e.breakpoints.up("xs"),{top:52}),Object(je.a)(t,e.breakpoints.up("sm"),{top:65}),Object(je.a)(t,e.breakpoints.up("md"),{top:65}),Object(je.a)(t,e.breakpoints.up("lg"),{top:65}),t)}})));var Je,Ke=function(e){var t=e.drawerBottom,a=e.setDrawerBottom,r=e.fileImageUrl,c=e.fileVideoUrl,i=e.setFileVideoUrl,s=e.setFileImageUrl,u=e.firebase,p=e.db,h=(e.storage,Qe()),f=m(),E=Object(l.a)(f,1)[0].user,g=Object(n.useState)(""),v=Object(l.a)(g,2),b=v[0],_=v[1],y=Object(d.h)().roomId;return o.a.createElement("div",null,o.a.createElement($.a,{variant:"persistent",anchor:"bottom",open:t,classes:{paper:h.drawerPaper,paperAnchorBottom:h.paperAnchorBottom}},o.a.createElement("div",{className:"drawerBottom__header"},o.a.createElement("div",{className:"drawerBottom__header_container"},o.a.createElement(x.a,{onClick:function(){a(!1)}},o.a.createElement(q.a,null)),o.a.createElement("p",null,"Preview"))),o.a.createElement("div",{className:"drawerBottom__content"},o.a.createElement("div",{className:"drawerBottom__content_photo"},r?o.a.createElement("img",{src:r,alt:""}):o.a.createElement("div",{className:"drawerBottom__content_video"},o.a.createElement("div",{className:"player-wrapper"},o.a.createElement(Te.a,{className:"react-player",width:"100%",height:"50%",url:c,controls:!0})))),o.a.createElement("div",{className:"drawerBottom__content_caption"},o.a.createElement("input",{type:"text",placeholder:"Add a caption...",value:b,onChange:function(e){return _(e.target.value)}}),o.a.createElement(We.a,{color:"primary","aria-label":"send",size:"large",onClick:function(e){e.preventDefault(),r&&(p.collection("rooms").doc(y).collection("messages").add({photo:r,name:E.displayName,uid:E.uid,caption:b,timestamp:u.firestore.FieldValue.serverTimestamp()}).then((function(e){p.collection("rooms").doc(y).collection("messages").doc(e.id).set({id:e.id},{merge:!0})})).catch((function(e){console.error("Error adding document: ",e)})),s(null)),c&&(p.collection("rooms").doc(y).collection("messages").add({video:c,name:E.displayName,uid:E.uid,caption:b,timestamp:u.firestore.FieldValue.serverTimestamp()}).then((function(e){p.collection("rooms").doc(y).collection("messages").doc(e.id).set({id:e.id},{merge:!0})})).catch((function(e){console.error("Error adding document: ",e)})),i(null)),_(""),a(!1)}},o.a.createElement("div",{className:"chat__icon"},o.a.createElement(Ze.a,null))))),o.a.createElement("div",{className:"drawerBottom__footer"},o.a.createElement("div",null,r?o.a.createElement("img",{src:r,alt:""}):null))))},qe=a(153),Xe=a(429),$e=a(479),et=a(243),tt=a.n(et),at=a(244),nt=a.n(at),ot=a(240),rt=a.n(ot),ct=a(242),lt=a.n(ct),it=a(241),st=a.n(it),mt=a(238),ut=a.n(mt),dt=a(239),pt=a.n(dt),ht=(a(423),a(424),a(233)),ft=a(234).a.div(Je||(Je=Object(ht.a)(["\n  height: ",";\n"])),(function(e){return e.drawerBottom?"100%":"62px"})),Et=a(95),gt=a.n(Et),vt=[{title:"Room",icon:o.a.createElement(ut.a,null),id:1e5*Math.random()},{title:"Contact",icon:o.a.createElement(pt.a,null),id:1e5*Math.random()},{title:"Document",icon:o.a.createElement(rt.a,null),id:1e5*Math.random()},{title:"Camera",icon:o.a.createElement(st.a,null),id:1e5*Math.random()},{title:"Photos & Videos",icon:o.a.createElement(lt.a,null),id:1e5*Math.random()}];var bt=function(e){var t=e.roomName,a=e.roomId,r=e.db,c=e.firebase,i=e.storage,s=m(),u=Object(l.a)(s,1)[0].user,d=Object(n.useState)(""),p=Object(l.a)(d,2),h=p[0],f=p[1],E=Object(n.useState)(!1),g=Object(l.a)(E,2),v=g[0],b=g[1],_=Object(n.useState)(null),w=Object(l.a)(_,2),O=w[0],j=w[1],S=Object(n.useState)(null),N=Object(l.a)(S,2),C=N[0],x=N[1],L=Object(n.useState)(!1),R=Object(l.a)(L,2),U=R[0],D=R[1],F=Object(n.useState)(!1),I=Object(l.a)(F,2),M=I[0],T=I[1],P=function(){y("All icons have the same functions, you can only upload images, gifs and videos!","attach","top-center"),T(!1===M)},B=function(e){var t=e.native;f(h+t)},z=function(){b(!1)},Y=function(){var e=Object(Q.a)(Z.a.mark((function e(a){var n,o,r,c,l,s;return Z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("fileSizeToastId",!((n=a.target.files[0]).size>12582912)){e.next=6;break}y("File should not exceed more than 12MB","fileSizeToastId","top-center"),e.next=32;break;case 6:if(o=i.ref(),!n.type.match("image.*")){e.next=20;break}return r=o.child("rooms/".concat(t,"/images/")),c=r.child((new Date).getTime()+" "+n.name),e.next=12,c.put(n);case 12:return e.t0=j,e.next=15,c.getDownloadURL();case 15:e.t1=e.sent,(0,e.t0)(e.t1),console.log("uploading image",O),e.next=31;break;case 20:if(!n.type.match("video.*")){e.next=31;break}return l=o.child("rooms/".concat(t,"/videos")),s=l.child((new Date).getTime()+" "+n.name),e.next=25,s.put(n);case 25:return e.t2=x,e.next=28,s.getDownloadURL();case 28:e.t3=e.sent,(0,e.t2)(e.t3),console.log("uploading video",C);case 31:D(!0);case 32:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(e){if(13===e.keyCode){e.preventDefault();a&&(/^((?:https?:)?\/\/)?((?:www|m)\.)?((?:youtube\.com|youtu.be))(\/(?:[\w\\-]+\?v=|embed\/|v\/)?)([\w\\-]+)(\S+)?$/.test(h)||/^https?:\/\/www\.facebook\.com.*\/(video(s)?|watch|story)(\.php?|\/).+$/.test(h)||/(http|https)?:\/\/(www\.|player\.)?vimeo\.com\/(?:channels\/(?:\w+\/)?|groups\/([^\\/]*)\/videos\/|video\/|)(\d+)(?:|\/\?)/.test(h)||/^https?:\/\/(soundcloud\.com|snd\.sc)\/(.*)$/.test(h)||/^.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/.test(h)?r.collection("rooms").doc(a).collection("messages").add({message:"",video:h,name:u.displayName,uid:u.uid,timestamp:c.firestore.FieldValue.serverTimestamp()}).then((function(e){console.log("Document written with ID: ",e.id),r.collection("rooms").doc(a).collection("messages").doc(e.id).set({id:e.id},{merge:!0})})).catch((function(e){console.error("Error adding document: ",e)})):/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\\.-]+)+[\w\-\\._~:/?#[\]@!\\$&'\\(\\)\\*\\+,;=.]+$/.test(h)?r.collection("rooms").doc(a).collection("messages").add({message:"",url:h,name:u.displayName,uid:u.uid,timestamp:c.firestore.FieldValue.serverTimestamp()}).then((function(e){console.log("Document written with ID: ",e.id),r.collection("rooms").doc(a).collection("messages").doc(e.id).set({id:e.id},{merge:!0})})).catch((function(e){console.error("Error adding document: ",e)})):/\S/.test(h)&&r.collection("rooms").doc(a).collection("messages").add({message:gt.a.AES.encrypt(h,"my-secret-key@123").toString(),name:u.displayName,uid:u.uid,timestamp:c.firestore.FieldValue.serverTimestamp()}).then((function(e){r.collection("rooms").doc(a).collection("messages").doc(e.id).set({id:e.id},{merge:!0})})).catch((function(e){console.error("Error adding document: ",e)}))),f(""),b(!1)}};return o.a.createElement(ft,{drawerBottom:U,className:"chat__footer"},o.a.createElement(Ke,{drawerBottom:U,setDrawerBottom:D,fileVideoUrl:C,fileImageUrl:O,setFileImageUrl:j,setFileVideoUrl:x,roomId:a,db:r,firebase:c,storage:i}),v?o.a.createElement(Fe.a,{only:["xs"]},o.a.createElement(A,{name:"Close",icon:o.a.createElement(q.a,{style:{color:"#de5751"}}),onClick:function(){return z()}})):null,o.a.createElement(A,{name:"Emoticons",icon:o.a.createElement(tt.a,{style:{color:"#de5751"}}),onClick:function(){b(!0)}}),v?o.a.createElement(o.a.Fragment,null,o.a.createElement(Fe.a,{only:["xs"]},o.a.createElement(qe.a,{onSelect:B})),o.a.createElement(Fe.a,{smUp:!0},o.a.createElement($e.a,{onClickAway:z},o.a.createElement(qe.a,{onSelect:B})))):null,o.a.createElement("div",null,o.a.createElement(A,{name:"Attach",icon:o.a.createElement(nt.a,{style:{color:"#de5751"}}),onClick:P}),M?o.a.createElement($e.a,{onClickAway:function(){T(!1)}},o.a.createElement("div",{className:"chat__attachFile"},vt.map((function(e){return o.a.createElement(Xe.a,{key:e.id,direction:"up",in:P,mountOnEnter:!0,unmountOnExit:!0},o.a.createElement(k.a,{title:o.a.createElement("span",{style:{fontSize:"14px",padding:"8px 5px 8px 5px"}},e.title),placement:"left"},o.a.createElement(We.a,{color:"primary","aria-label":"person"},o.a.createElement("div",{className:"chat__icon"},o.a.createElement("label",{htmlFor:"file-input"},e.icon),o.a.createElement("input",{id:"file-input",type:"file",onChange:Y,accept:"image/*,video/mp4,video/3gpp,video/quicktime"})))))})))):null),o.a.createElement("form",null,o.a.createElement("textarea",{required:!0,value:h,onChange:function(e){return f(e.target.value)},placeholder:"Type a message",type:"text",rows:"1",onKeyDown:V})),o.a.createElement(A,{name:"Send Message",onChange:function(e){return f(e.target.value)},icon:o.a.createElement(Ze.a,{style:{color:"#de5751"}}),onClick:V}))},_t=a(245),yt=a.n(_t);a(425);var wt=function(e){var t=e.showLandingScreenPhoto;return o.a.createElement("div",{className:"chat-landing-screen"},o.a.createElement("div",null,o.a.createElement(J.a,{in:t,style:{transitionDelay:t?"300ms":"0ms"}},o.a.createElement("img",{className:"chat-landing-screen__photo",src:"https://firebasestorage.googleapis.com/v0/b/tattle-9359.appspot.com/o/Folder%2Flogo.webp?alt=media&token=c0d6ec1c-5261-4864-a820-539a731fb7d1",alt:"TattleLogo"}))),o.a.createElement("div",{className:"chat-landing-screen__title"},o.a.createElement("p",null,"Keeps you Connected")),o.a.createElement("div",null,o.a.createElement("p",null,"Tattle is driven by a fascination for mobile technology that was once viewed as a passing trend.")),o.a.createElement(Ce.a,null),o.a.createElement("div",{className:"chat-landing-screen__footer"},o.a.createElement(yt.a,null),o.a.createElement("p",null,"Tattle is available for Windows."),o.a.createElement("a",{target:"_blank",href:"https://tattle-9359.web.app",rel:"noopener noreferrer"},"Get it here.")))};a(223),a(426);var Ot=function(e){var t=e.isRoomExist,a=Object(d.g)(),r=m(),c=Object(l.a)(r,1)[0].user,i=Object(d.h)().roomId,s=Object(n.useState)(""),u=Object(l.a)(s,2),h=u[0],f=u[1],E=Object(n.useState)(""),b=Object(l.a)(E,2),_=b[0],y=b[1],w=Object(n.useState)(""),O=Object(l.a)(w,2),j=O[0],S=O[1],N=Object(n.useState)(""),C=Object(l.a)(N,2),k=C[0],x=C[1],A=Object(n.useState)([]),L=Object(l.a)(A,2),R=L[0],U=L[1],D=Object(n.useState)(!1),F=Object(l.a)(D,2),I=F[0],M=F[1],T=Object(n.useState)(!1),P=Object(l.a)(T,2),B=P[0],z=P[1];return Object(n.useEffect)((function(){i?(v.collection("rooms").doc(i).onSnapshot((function(e){var t,a,n,o;y(null===(t=e.data())||void 0===t?void 0:t.name),S(null===(a=e.data())||void 0===a?void 0:a.createdBy),x(null===(n=e.data())||void 0===n?void 0:n.roomOwner),f(null===(o=e.data())||void 0===o?void 0:o.id)})),v.collection("rooms").doc(i).collection("messages").orderBy("timestamp","asc").onSnapshot((function(e){U(e.docs.map((function(e){return e.data()}))),M(!0)})),z(!1)):(z(!0),a.push("/"))}),[i,a]),o.a.createElement("div",{className:"chat"},i?o.a.createElement(o.a.Fragment,null,o.a.createElement("div",null,o.a.createElement(Ie,{roomCreatedBy:j,roomOwner:k,roomName:_,roomId:i,_roomId:h,messages:R,db:v,history:a,isRoomExist:t})),o.a.createElement("div",{className:"chat__body"},I?o.a.createElement(He,{roomCreatedBy:j,roomOwner:k,roomId:i,messages:R,user:c,isRoomExist:t}):o.a.createElement("div",{className:"chat__body_loading"},o.a.createElement("div",null,o.a.createElement(_e.a,null)))),o.a.createElement("div",null,o.a.createElement(bt,{roomName:_,roomId:i,db:v,firebase:p.a,storage:g}))):o.a.createElement(wt,{showLandingScreenPhoto:B}))},jt=a(480);a(427);var St=function(){var e=m(),t=Object(l.a)(e,2),a=t[0].user,r=t[1],c=Object(n.useState)([]),i=Object(l.a)(c,2),s=i[0],h=i[1],E=Object(n.useState)(""),g=Object(l.a)(E,2),w=g[0],O=g[1],j=Object(n.useState)(!1),N=Object(l.a)(j,2),C=N[0],k=N[1];return Object(n.useEffect)((function(){var e=f.onAuthStateChanged((function(e){if(e){if(r(b(e)),k(!0),v.collection("rooms").orderBy("timestamp","desc").onSnapshot((function(e){return h(e.docs.map((function(e){return{id:e.id,data:e.data()}})))})),!0===e.isAnonymous&&null===e.displayName){var t="Anonymous "+Math.floor(1e6*Math.random());f.currentUser.updateProfile({displayName:t,photoURL:""}),v.collection("users").doc(e.uid).set({name:t,about:"Hey there! I am using Tattle.",photoURL:"https://avatars.dicebear.com/api/human/ugtjh.svg",role:"anonymous",dateJoined:p.a.firestore.FieldValue.serverTimestamp()}).then((function(){console.log("Document successfully updated!")})).catch((function(e){console.error("Error updating document: ",e)}))}if(e.uid&&!1===e.isAnonymous&&null!==e.photoURL){v.collection("users").doc(e.uid).get().then((function(t){t.exists||v.collection("users").doc(e.uid).set({name:e.displayName,about:"Hey there! I am using Tattle.",photoURL:a.photoURL,role:"regular",dateJoined:p.a.firestore.FieldValue.serverTimestamp()})})).catch((function(e){y("".concat(e),"errorAbout","top-center")}))}else if(e.uid&&!1===e.isAnonymous&&null===e.photoURL){v.collection("users").doc(e.uid).get().then((function(t){t.exists?console.log("USER EXIST"):v.collection("users").doc(e.uid).set({name:e.displayName,about:"Hey there! I am using Tattle.",photoURL:"",role:"regular",dateJoined:p.a.firestore.FieldValue.serverTimestamp()})})).catch((function(e){y("".concat(e),"errorAbout","top-center")}))}}else r(b(null)),k(!0)}));return function(){e()}}),[r,a]),o.a.createElement("div",{className:"app ".concat(!1===C&&"app-no-bg")},C?o.a.createElement(o.a.Fragment,null,o.a.createElement(_.a,{position:"top-center",autoClose:5e3,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0}),a?o.a.createElement("div",{className:"app__body"},o.a.createElement(u.a,null,o.a.createElement(d.d,null,o.a.createElement(d.b,{exact:!0,path:"/"},o.a.createElement(Oe,{rooms:s,setIsRoomExist:O,isRoomExist:w}),o.a.createElement(Fe.a,{only:["xs"]}," ",o.a.createElement(Ot,{isRoomExist:w}))),o.a.createElement(d.b,{exact:!0,path:"/rooms/:roomId"},o.a.createElement(Fe.a,{only:["xs"]}," ",o.a.createElement(Oe,{rooms:s,setIsRoomExist:O,isRoomExist:w})),o.a.createElement(Ot,{isRoomExist:w})),o.a.createElement(d.b,{path:"*"},o.a.createElement(d.a,{to:"/"}))))):o.a.createElement(S,null)):o.a.createElement("div",{className:"app__loading"},o.a.createElement("div",null,o.a.createElement("div",{className:"app__loading_circular"},o.a.createElement(_e.a,null)),o.a.createElement("div",{className:"app__loading_linear"},o.a.createElement(jt.a,null)))))},Nt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ct(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var kt=a(152),xt="SET_USER",At=function(e,t){switch(t.type){case xt:return Object(kt.a)(Object(kt.a)({},e),{},{user:t.user});default:return e}};c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(s,{initialState:{user:null},reducer:At},o.a.createElement(St,null))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");Nt?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Ct(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):Ct(t,e)}))}}()}},[[428,1,2]]]);
//# sourceMappingURL=main.cf7bba2c.chunk.js.map