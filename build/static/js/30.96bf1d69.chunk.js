(this.webpackJsonptattle=this.webpackJsonptattle||[]).push([[30],{402:function(e,t,a){},474:function(e,t,a){"use strict";a.r(t);var n=a(273),l=a.n(n),o=a(274),r=a(26),c=a(2),i=a.n(c),u=a(35),s=a(42),m=a(276),d=a(207),p=a(459),f=a(475),E=a(488),h=a(476),b=a(477),v=a(149),g=a(206),_=a(176),O=a.n(_),j=a(150),y=a.n(j),k=a(404),w=a.n(k),P=a(403),N=a.n(P),L=(a(402),i.a.lazy((function(){return Promise.all([a.e(4),a.e(33)]).then(a.bind(null,177))}))),C=i.a.lazy((function(){return a.e(27).then(a.bind(null,450))})),x=Object(g.a)((function(e){return{root:{display:"flex"},drawerPaper:{position:"absolute"}}}));t.default=function(e){var t=e.drawerLeft,a=e.setDrawerLeft,n=e.db,g=e.auth,_=e.storage,j=x(),k=Object(u.b)(),P=Object(r.a)(k,1)[0].user,S=Object(c.useState)(""),T=Object(r.a)(S,2),U=T[0],D=T[1],F=Object(c.useState)(""),R=Object(r.a)(F,2),M=R[0],z=R[1],I=Object(c.useState)(!1),A=Object(r.a)(I,2),B=A[0],H=A[1],J=Object(c.useState)(!1),Y=Object(r.a)(J,2),G=Y[0],V=Y[1],q=Object(c.useState)(!1),K=Object(r.a)(q,2),Q=K[0],W=K[1],X=Object(c.useState)(null),Z=Object(r.a)(X,2),$=Z[0],ee=Z[1],te=Object(c.useState)(!1),ae=Object(r.a)(te,2),ne=ae[0],le=ae[1],oe=Object(c.useState)(null),re=Object(r.a)(oe,2),ce=re[0],ie=re[1],ue=Object(c.useState)(""),se=Object(r.a)(ue,2),me=se[0],de=se[1];Object(c.useEffect)((function(){D(P.displayName),n.collection("users").doc(P.uid).onSnapshot((function(e){var t,a;de(null===(t=e.data())||void 0===t?void 0:t.photoURL),z(null===(a=e.data())||void 0===a?void 0:a.about)}))}),[P.uid,P.displayName,n]);var pe=function(){var e=Object(o.a)(l.a.mark((function e(t){var a,n,o,r,c,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("imageFileSizeToastId",!((a=t.target.files[0]).size>3145728)){e.next=6;break}Object(s.a)("Image should not exceed more than 3Mb","imageFileSizeToastId","top-center"),e.next=30;break;case 6:if(n=_.ref(),!0!==P.isAnonymous){e.next=20;break}return o=n.child("user/anonymous/".concat(P.uid)),r=o.child(a.name),e.next=12,r.put(a);case 12:return e.t0=ee,e.next=15,r.getDownloadURL();case 15:e.t1=e.sent,(0,e.t0)(e.t1),console.log("uploading image",$),e.next=30;break;case 20:return c=n.child("user/regular/".concat(P.uid)),i=c.child(a.name),e.next=24,i.put(a);case 24:return e.t2=ee,e.next=27,i.getDownloadURL();case 27:e.t3=e.sent,(0,e.t2)(e.t3),console.log("uploading image",$);case 30:ie(null),le(!0);case 32:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fe=function(){$?(g.currentUser.updateProfile({photoURL:$}),n.collection("users").doc(P.uid).set({photoURL:$},{merge:!0}),le(!1)):Object(s.a)("Select photo to upload!","uploadPhotoError","top-center")},Ee=[{title:"View Photo",onClick:function(){return P?W(!0):Object(s.a)("You have no photo!","viewPhoto","top-center"),void ie(null)}},{title:"Take photo",onClick:function(){Object(s.a)("Take photo is not yet available!","takePhoto","top-center")}},{title:i.a.createElement("div",{className:"profileMenu_uploadPhoto"},i.a.createElement("label",{htmlFor:"file-input"},"Upload photo"),i.a.createElement("input",{id:"file-input",type:"file",onChange:pe,accept:"image/*"})),onClick:function(){return fe()}},{title:"Removed photo",onClick:function(){Object(s.a)("Removed photo is not yet available!","removedPhoto","top-center")}}];return i.a.createElement(i.a.Suspense,{fallback:i.a.createElement("p",null,"Loading")},i.a.createElement("div",null,i.a.createElement(d.a,{anchor:"left",variant:"persistent",open:t,classes:{paper:j.drawerPaper}},i.a.createElement("div",{className:"drawerLeft__header"},i.a.createElement("div",{className:"drawerLeft__header_container"},i.a.createElement(v.a,{onClick:function(){a(!1),H(!1),V(!1)}},i.a.createElement(y.a,null)),i.a.createElement("p",null,"Profile"))),i.a.createElement("div",{className:"drawerLeft__content"},i.a.createElement("div",{className:"drawerLeft__content_photo"},i.a.createElement("div",{className:"profilePhoto"},i.a.createElement(m.a,{in:t,style:{transitionDelay:t?"300ms":"0ms"}},me?i.a.createElement(p.a,{src:me,className:"profilePhoto__layer_bottom"}):i.a.createElement(p.a,null)),i.a.createElement("div",{className:"profilePhoto__layer_top",onClick:function(e){ie(e.currentTarget)}},i.a.createElement("div",{className:"profilePhoto__text"},i.a.createElement(O.a,null),i.a.createElement("p",null,"CHANGE"),i.a.createElement("p",null,"PROFILE PHOTO")))),i.a.createElement(L,{menuLists:Ee,menu:ce,handleMenuClose:function(){ie(null)}}),i.a.createElement(C,{open:Q,close:function(){W(!1)},photo:me,user:P})),i.a.createElement("div",{className:"profileMenu__diaglog"},i.a.createElement(f.a,{open:ne,onClose:function(){le(!1)},"aria-labelledby":"form-dialog-title"},i.a.createElement(E.a,{id:"form-dialog-title-drawerLeft"},"Upload Photo"),i.a.createElement(h.a,{id:"form-dialog-content"},i.a.createElement("div",{className:"profileMenu__uploadPhoto_dialog"},i.a.createElement("img",{src:$,alt:""}))),i.a.createElement(b.a,null,i.a.createElement("div",{className:"profileMenu_uploadPhoto_iconButton"},i.a.createElement(v.a,{onClick:fe},i.a.createElement(N.a,null)))))),i.a.createElement("div",{className:"drawerLeft__content_name"},i.a.createElement("p",null,"Your Name"),i.a.createElement("form",null,B?i.a.createElement(i.a.Fragment,null,i.a.createElement("input",{value:U,onChange:function(e){return D(e.target.value)},type:"text",styles:{borderBottom:"1px solid green !important"}}),i.a.createElement(N.a,{onClick:function(e){e.preventDefault(),P.uid&&(n.collection("users").doc(P.uid).update({name:U}).then((function(){console.log("Document successfully updated!")})).catch((function(e){console.error("Error updating document: ",e)})),g.currentUser.updateProfile({displayName:U})),H(!1)}})):i.a.createElement(i.a.Fragment,null,i.a.createElement("span",null,U),i.a.createElement(w.a,{onClick:function(){H(!0)}})))),i.a.createElement("div",{className:"drawerLeft__note"},i.a.createElement("span",null,"This is not your username or pin. This name will be visible to your Tattle contacts.")),i.a.createElement("div",{className:"drawerLeft__content_name"},i.a.createElement("p",null,"About"),i.a.createElement("form",null,G?i.a.createElement(i.a.Fragment,null,i.a.createElement("input",{value:M,onChange:function(e){return z(e.target.value)},type:"text"}),i.a.createElement(N.a,{onClick:function(e){e.preventDefault(),P.uid&&n.collection("users").doc(P.uid).update({about:M}).then((function(){console.log("Document successfully updated!")})).catch((function(e){console.error("Error updating document: ",e)})),V(!1)}})):i.a.createElement(i.a.Fragment,null,i.a.createElement("span",null,M),i.a.createElement(w.a,{onClick:function(){V(!0)}}))))))))}}}]);
//# sourceMappingURL=30.96bf1d69.chunk.js.map