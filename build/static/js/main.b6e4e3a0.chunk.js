(this.webpackJsonptattle=this.webpackJsonptattle||[]).push([[0],{161:function(e,t,a){},259:function(e,t,a){},266:function(e,t,a){},269:function(e,t,a){},270:function(e,t,a){},271:function(e,t,a){},276:function(e,t){},278:function(e,t){},288:function(e,t){},290:function(e,t){},317:function(e,t){},319:function(e,t){},320:function(e,t){},325:function(e,t){},327:function(e,t){},346:function(e,t){},358:function(e,t){},361:function(e,t){},388:function(e,t,a){},389:function(e,t,a){},390:function(e,t,a){},391:function(e,t,a){},392:function(e,t,a){},393:function(e,t,a){},411:function(e,t,a){},412:function(e,t,a){},415:function(e,t,a){},416:function(e,t,a){},417:function(e,t,a){},418:function(e,t,a){},419:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(14),c=a.n(r),l=(a(259),a(6)),i=Object(n.createContext)(),s=function(e){var t=e.reducer,a=e.initialState,r=e.children;return o.a.createElement(i.Provider,{value:Object(n.useReducer)(t,a)},r)},m=function(){return Object(n.useContext)(i)},u=a(48),d=a(27),p=a(85),h=p.a.initializeApp({apiKey:"AIzaSyCF7lHw_Z7DmZgpoZuYIGveD0eZ8ha7Qyg",authDomain:"tattle-9359.firebaseapp.com",databaseURL:"https://tattle-9359-default-rtdb.firebaseio.com/",projectId:"tattle-9359",storageBucket:"tattle-9359.appspot.com",messagingSenderId:"849640668400",appId:"1:849640668400:web:91c77b3a931a325ef4d635",measurementId:"G-17X1MHRTRX"}).firestore(),E=p.a.auth(),f=new p.a.auth.GoogleAuthProvider,g=p.a.storage(),v=h;function b(e){return{type:"SET_USER",user:e}}var _=a(106),w=function(e,t,a){_.b.info(e,{toastId:t,position:a,autoClose:5e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})},y=a(217),O=a.n(y),j=a.p+"static/media/logo.179025b4.webp";a(266);var S=function(){return o.a.createElement("div",{className:"login"},o.a.createElement("div",{className:"login__container"},o.a.createElement("img",{rel:"preload",src:j,alt:"Tattle Logo"}),o.a.createElement("div",{className:"login__text"},o.a.createElement("h2",null,"Keeps you Connected"),o.a.createElement("br",null),o.a.createElement("p",null,"Tattle is driven by a fascination for communication "),o.a.createElement("p",null,"technology that was once viewed as a passing trend.")),o.a.createElement("div",{className:"login__withGoogle",onClick:function(){E.signInWithPopup(f).catch((function(e){return w("".concat(e),"google","top-center")}))}},o.a.createElement("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAD8klEQVRogc2aW6iUVRTHf845apiXY4lgFlYoSealSMuQiiwjQkEsIqjH6CUIeu/NehAEC8Oi7EoUeSLJk90IAi8pFlREF1SiOtWb1vFW56j/WLUmpmkG197f983MHzYzD/vy/3/7svZaa4+TRAmYAlwOLASWAvOAS4DpwGTgLHAcOAoMA4eAfcDX/v9EUQpFhVwP3AGs8v852AN8AOwEPs1mYkIyymJJr0o6ofIwIulNSStzOKU2mC1pq6SjJQpoxilJL0m6qCohd0n6vkIBzfhR0v1lCpkg6ckOCmjGYxEh/efYQnbivAyszd6ExXAQ2Ft0s0+WNNTFmdgpaU7RpTVe0ntdFLFZUl8Zm31DlwSMSXok5/htZRDvAV7PXNmjwLfALrfcPwNH3LIPAHOAZcCNwHxgYkNbq/sA8G7WyE3KZkgazvyS29yYjQt8Qatzi6Ttkv6Q9KWkq3Jmot3SejpDxO5ca+zlJkkzi4hoFrJc0miiiGckTSpKooxSa1hlDwPjE1bleuBB4GTWmi4b/jUWSvo9cSa6PguNpT4jZrmnBr/RF8BDPTELDaj5EXh7sP6YixjrCLsEmJC5wHXBJub87O4J5k0wIUuAvkDdY8CmjrJLgN1+FwWrfwd8nDnOav6x2lVhyIQsCHZ+oACJJS6mKky1pTU72PknBUiMVCjCMFBLOHaHKyZTBNNNyLRg5SNVsymA801INLA12pMSHCbkt2DdgcrZ5GOk5vYhgst6XcgvwcrXFBgo5Vadgx9MyFfBhisLDFS/mylYzDU+5b8RHOr322wEi1zMRxlC3gIOA38G659xv/7RYP3P7S6/QNKZoB+yo4M+xvNBTsb9SmswUdKuYCNzhVd0QMQKD2hEsN/c7ZpP9/vBKbRN+1TFm/c8YLNfaCPYYe523UN8O+E+ZHtlSzUa/oa5CouDdY859/9EUV4LTmUdj1ewpDYmcthWb9vYyfLETgzPlhQOmiJpS8b4N7QSYuW5jM4sQHdbARG3StqXMe6Ljf00d3qhZ4pScVrSoKRViSHTQW+bil89Dfhvn62C2HcDb2RuVLPg33iAYj/wU0MQ21LVl3r62ozdFU1B7BTc+79Ae5sv1q20QgSbWnFul2e3M3w7cGfmF6sKlo9f0+qqU2sz4GnPkwz1mIh17e5r7YTgzypsLQ5Wxy2Md5zL8bYNAidMn6/LbuEJSf3n4ply3q+TdLiDYswM3Bfll2q8Zvn1uuonHC/4WGFuudbYHtW8UrIgy88M5qbxij5zutq9Rjumb87sw4znh76hP8slUtbDM/MhzFLbw7Nr/eHZxcAF/gzEBrETx6y8RSztaYZZ/vrDs2LpO+AvpvyKMZBkRBsAAAAASUVORK5CYII=",alt:"Google Logo"}),o.a.createElement("span",null,"Sign in with Google")),o.a.createElement("div",{className:"login__withGoogle login__Anonymously",onClick:function(){E.signInAnonymously().catch((function(e){return w("".concat(e),"anonymous","top-center")}))}},o.a.createElement(O.a,null),o.a.createElement("span",null,"Login Anonymously"))))},N=a(466);var C=function(e){var t=e.photoURL,a=e.onClick;return o.a.createElement("div",{style:{cursor:"pointer"}},o.a.createElement(N.a,{src:t,onClick:a}))},k=a(220),x=a.n(k),A=a(464),L=a(467);var R=function(e){var t=e.menuLists,a=e.menu,n=e.handleMenuClose;return o.a.createElement("div",null,o.a.createElement(A.a,{id:"simple-menu",anchorEl:a,keepMounted:!0,open:Boolean(a),onClose:n,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},getContentAnchorEl:null},t.map((function(e){return o.a.createElement(L.a,{key:e.id,onClick:e.onClick},e.title)}))))},U=a(84),D=a.n(U),I=a(112),F=a(454),T=a(451),M=a(468),P=a(453),B=a(452),z=a(54),V=a.n(z);a(269);var Y=function(e){var t=e.open,a=e.close,n=e.user,r=e.photo;return o.a.createElement(T.a,{open:t,fullScreen:!0,onClose:a,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},o.a.createElement(M.a,{id:"alert-dialog-title-dialogCustom"},o.a.createElement("div",null,o.a.createElement(N.a,{src:n.photoURL})),o.a.createElement("div",null,o.a.createElement(B.a,{edge:"end",color:"inherit",onClick:a,"aria-label":"close"},o.a.createElement(V.a,null)))),o.a.createElement(P.a,null,o.a.createElement(F.a,{in:t,style:{transitionDelay:t?"300ms":"0ms"}},o.a.createElement("img",{src:r,alt:"",className:"DialogCustom__photo"}))))},H=a(456),W=a(457),G=a(455),Z=a(68),Q=a.n(Z),J=a(78),K=a.n(J),q=a(148),X=a.n(q),$=a(118),ee=a.n($),te=(a(270),Object(G.a)((function(e){return{root:{display:"flex"},drawerPaper:{position:"absolute"}}})));var ae=function(e){var t=e.drawerLeft,a=e.setDrawerLeft,r=e.db,c=e.auth,i=e.storage,s=te(),u=m(),d=Object(l.a)(u,1)[0].user,p=Object(n.useState)(""),h=Object(l.a)(p,2),E=h[0],f=h[1],g=Object(n.useState)(""),v=Object(l.a)(g,2),b=v[0],_=v[1],y=Object(n.useState)(!1),O=Object(l.a)(y,2),j=O[0],S=O[1],C=Object(n.useState)(!1),k=Object(l.a)(C,2),x=k[0],A=k[1],L=Object(n.useState)(!1),U=Object(l.a)(L,2),z=U[0],V=U[1],G=Object(n.useState)(null),Z=Object(l.a)(G,2),J=Z[0],q=Z[1],$=Object(n.useState)(!1),ae=Object(l.a)($,2),ne=ae[0],oe=ae[1],re=Object(n.useState)(null),ce=Object(l.a)(re,2),le=ce[0],ie=ce[1],se=Object(n.useState)(""),me=Object(l.a)(se,2),ue=me[0],de=me[1];Object(n.useEffect)((function(){f(d.displayName),r.collection("users").doc(d.uid).onSnapshot((function(e){var t,a;de(null===(t=e.data())||void 0===t?void 0:t.photoURL),_(null===(a=e.data())||void 0===a?void 0:a.about)}))}),[d.uid,d.displayName,r]);var pe=function(){var e=Object(I.a)(D.a.mark((function e(t){var a,n,o,r,c,l;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("imageFileSizeToastId",!((a=t.target.files[0]).size>3145728)){e.next=6;break}w("Image should not exceed more than 3Mb","imageFileSizeToastId","top-center"),e.next=30;break;case 6:if(n=i.ref(),!0!==d.isAnonymous){e.next=20;break}return o=n.child("user/anonymous/".concat(d.uid)),r=o.child(a.name),e.next=12,r.put(a);case 12:return e.t0=q,e.next=15,r.getDownloadURL();case 15:e.t1=e.sent,(0,e.t0)(e.t1),console.log("uploading image",J),e.next=30;break;case 20:return c=n.child("user/regular/".concat(d.uid)),l=c.child(a.name),e.next=24,l.put(a);case 24:return e.t2=q,e.next=27,l.getDownloadURL();case 27:e.t3=e.sent,(0,e.t2)(e.t3),console.log("uploading image",J);case 30:ie(null),oe(!0);case 32:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),he=function(){J?(c.currentUser.updateProfile({photoURL:J}),r.collection("users").doc(d.uid).set({photoURL:J},{merge:!0}),oe(!1)):w("Select photo to upload!","uploadPhotoError","top-center")},Ee=[{title:"View Photo",onClick:function(){return d?V(!0):w("You have no photo!","viewPhoto","top-center"),void ie(null)},id:1e5*Math.random()},{title:"Take photo",onClick:function(){w("Take photo is not yet available!","takePhoto","top-center")},id:1e5*Math.random()},{title:o.a.createElement("div",{className:"profileMenu_uploadPhoto"},o.a.createElement("label",{htmlFor:"file-input"},"Upload photo"),o.a.createElement("input",{id:"file-input",type:"file",onChange:pe,accept:"image/*"})),onClick:function(){return he()},id:1e5*Math.random()},{title:"Removed photo",onClick:function(){w("Removed photo is not yet available!","removedPhoto","top-center")},id:1e5*Math.random()}];return o.a.createElement("div",null,o.a.createElement(H.a,{anchor:"left",variant:"persistent",open:t,classes:{paper:s.drawerPaper}},o.a.createElement("div",{className:"drawerLeft__header"},o.a.createElement("div",{className:"drawerLeft__header_container"},o.a.createElement(B.a,{onClick:function(){a(!1),S(!1),A(!1)}},o.a.createElement(K.a,null)),o.a.createElement("p",null,"Profile"))),o.a.createElement("div",{className:"drawerLeft__content"},o.a.createElement("div",{className:"drawerLeft__content_photo"},o.a.createElement("div",{className:"profilePhoto"},o.a.createElement(F.a,{in:t,style:{transitionDelay:t?"300ms":"0ms"}},ue?o.a.createElement(N.a,{src:ue,className:"profilePhoto__layer_bottom"}):o.a.createElement(N.a,null)),o.a.createElement("div",{className:"profilePhoto__layer_top",onClick:function(e){ie(e.currentTarget)}},o.a.createElement("div",{className:"profilePhoto__text"},o.a.createElement(Q.a,null),o.a.createElement("p",null,"CHANGE"),o.a.createElement("p",null,"PROFILE PHOTO")))),o.a.createElement(R,{menuLists:Ee,menu:le,handleMenuClose:function(){ie(null)}}),o.a.createElement(Y,{open:z,close:function(){V(!1)},photo:ue,user:d})),o.a.createElement("div",{className:"profileMenu__diaglog"},o.a.createElement(T.a,{open:ne,onClose:function(){oe(!1)},"aria-labelledby":"form-dialog-title"},o.a.createElement(M.a,{id:"form-dialog-title-drawerLeft"},"Upload Photo"),o.a.createElement(P.a,{id:"form-dialog-content"},o.a.createElement("div",{className:"profileMenu__uploadPhoto_dialog"},o.a.createElement("img",{src:J,alt:""}))),o.a.createElement(W.a,null,o.a.createElement("div",{className:"profileMenu_uploadPhoto_iconButton"},o.a.createElement(B.a,{onClick:he},o.a.createElement(ee.a,null)))))),o.a.createElement("div",{className:"drawerLeft__content_name"},o.a.createElement("p",null,"Your Name"),o.a.createElement("form",null,j?o.a.createElement(o.a.Fragment,null,o.a.createElement("input",{value:E,onChange:function(e){return f(e.target.value)},type:"text",styles:{borderBottom:"1px solid green !important"}}),o.a.createElement(ee.a,{onClick:function(e){e.preventDefault(),d.uid&&(r.collection("users").doc(d.uid).update({name:E}).then((function(){console.log("Document successfully updated!")})).catch((function(e){console.error("Error updating document: ",e)})),c.currentUser.updateProfile({displayName:E})),S(!1)}})):o.a.createElement(o.a.Fragment,null,o.a.createElement("span",null,E),o.a.createElement(X.a,{onClick:function(){S(!0)}})))),o.a.createElement("div",{className:"drawerLeft__note"},o.a.createElement("span",null,"This is not your username or pin. This name will be visible to your Tattle contacts.")),o.a.createElement("div",{className:"drawerLeft__content_name"},o.a.createElement("p",null,"About"),o.a.createElement("form",null,x?o.a.createElement(o.a.Fragment,null,o.a.createElement("input",{value:b,onChange:function(e){return _(e.target.value)},type:"text"}),o.a.createElement(ee.a,{onClick:function(e){e.preventDefault(),d.uid&&r.collection("users").doc(d.uid).update({about:b}).then((function(){console.log("Document successfully updated!")})).catch((function(e){console.error("Error updating document: ",e)})),A(!1)}})):o.a.createElement(o.a.Fragment,null,o.a.createElement("span",null,b),o.a.createElement(X.a,{onClick:function(){A(!0)}})))))))},ne=a(113),oe=a.n(ne),re=a(218),ce=a.n(re);a(271);var le=function(e){var t=e.placeholder,a=e.setSearch,r=e.search,c=Object(n.useState)(!1),i=Object(l.a)(c,2),s=i[0],m=i[1];return o.a.createElement("div",{className:"search ".concat(!0===s&&"search__bgColorChange")},o.a.createElement("div",{className:"search__container"},o.a.createElement("span",{className:"".concat(!0===s?"arroww":"")},s?o.a.createElement(ce.a,null):o.a.createElement(oe.a,null)),o.a.createElement("input",{value:r,onChange:function(e){return a(e.target.value)},type:"text",placeholder:t,required:!0,onFocus:function(){m(!0)},onBlur:function(){m(!1)}})))},ie=a(146),se=a.n(ie),me=(a(161),a(77));var ue=function(e){var t,a,r,c,i,s=e.id,m=e.name,d=Object(n.useState)([]),p=Object(l.a)(d,2),h=p[0],E=p[1];Object(n.useEffect)((function(){f()}),[s]);var f=function(){s&&v.collection("rooms").doc(s).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){return E(e.docs.map((function(e){return e.data()})))}))};return o.a.createElement(u.b,{to:"/rooms/".concat(s),className:"sidebarChat__link"},o.a.createElement("div",{className:"sidebarChat"},o.a.createElement(N.a,null,m[0]),o.a.createElement("div",{className:"sidebarChat__info"},o.a.createElement("h2",null,m),(null===(t=h[0])||void 0===t?void 0:t.photo)?o.a.createElement("div",{className:"sideChat__photo"},o.a.createElement(Q.a,null)," ",o.a.createElement("span",null,"Photo")):null,(null===(a=h[0])||void 0===a?void 0:a.video)?o.a.createElement("div",{className:"sideChat__photo"},o.a.createElement(se.a,null)," ",o.a.createElement("span",null,"Video")):null,o.a.createElement("p",null,(null===(r=h[0])||void 0===r?void 0:r.message)?function(e){var t=me.AES.decrypt(e,"my-secret-key@123").toString(me.enc.Utf8);return e?t:e}(null===(c=h[0])||void 0===c?void 0:c.message):""),o.a.createElement("p",null,null===(i=h[0])||void 0===i?void 0:i.url))))},de=a(458);a(388);var pe=function(e){var t=e.data;return o.a.createElement(u.b,{to:"",className:"sidebarChat__link"},o.a.createElement("div",{className:"sidebarChat"},o.a.createElement(N.a,{src:t.photoURL}),o.a.createElement("div",{className:"sidebarChat__info"},o.a.createElement("h2",null,t.name),o.a.createElement("p",null,t.email))))},he=Object(G.a)((function(e){return{root:{display:"flex"},drawerPaper:{position:"absolute"}}}));var Ee=function(e){var t,a=e.drawer2,r=e.setDrawer2,c=(e.rooms,e.setIsRoomExist,e.isRoomExist,e.userData),i=he(),s=(Object(d.g)(),Object(d.h)().roomId,Object(n.useState)("")),m=Object(l.a)(s,2),u=m[0],p=m[1],h=Object(n.useState)(!1),E=Object(l.a)(h,2),f=E[0],g=(E[1],Object(n.useState)(!1)),v=Object(l.a)(g,2),b=v[0];return v[1],o.a.createElement("div",null,o.a.createElement(H.a,{anchor:"left",variant:"persistent",open:a,classes:{paper:i.drawerPaper}},o.a.createElement("div",{className:"drawerLeft__header"},o.a.createElement("div",{className:"drawerLeft__header_container"},o.a.createElement(B.a,{onClick:function(){r(!1)}},o.a.createElement(K.a,null)),o.a.createElement("p",null,"Add User"))),o.a.createElement("div",{className:"drawerLeft__content"},o.a.createElement(le,{search:u,setSearch:p,placeholder:"Search or start new chat"}),o.a.createElement("div",{className:"drawerLeft__not"},o.a.createElement("span",null,"Select or Search for your new friends here at Tattle.")),o.a.createElement("div",{className:"sidebar__chats"},!1===f?o.a.createElement(o.a.Fragment,null,u?o.a.createElement(o.a.Fragment,null,o.a.createElement("div",null,c?c.filter((t=u,function(e){return(e.name+"").toLowerCase().includes(t.toLowerCase())||!t})).map((function(e){return o.a.createElement(pe,{data:e})})):o.a.createElement("div",{className:"sidebar__chatsContainer_empty"},o.a.createElement("span",null,"No Users searched found")))):o.a.createElement(o.a.Fragment,null,c?c.map((function(e){return o.a.createElement(pe,{data:e})})):o.a.createElement("div",{className:"sidebar__chatsContainer_empty"},o.a.createElement("span",null,"No Users found")))):o.a.createElement("div",{className:"sidebar__chatsContainer_loading"},o.a.createElement("div",null,o.a.createElement(de.a,null))),b&&f?o.a.createElement("div",{className:"sidebar__chatsContainer_empty"},o.a.createElement("span",null,"No chats")):null))))},fe=a(465);var ge=function(e){var t=e.name,a=e.icon,n=e.onClick;return o.a.createElement("div",null,o.a.createElement(fe.a,{title:o.a.createElement("span",{style:{fontSize:"14px",padding:"8px 5px 8px 5px"}},t),placement:"bottom-end"},o.a.createElement(B.a,{onClick:n},a)))},ve=a(114),be=a.n(ve);a(389);var _e=function(e){var t=e.rooms,a=e.setIsRoomExist,r=e.isRoomExist,c=Object(d.g)(),i=Object(d.h)().roomId,s=m(),u=Object(l.a)(s,1)[0].user,p=Object(n.useState)(""),h=Object(l.a)(p,2),f=h[0],b=h[1],_=Object(n.useState)(!1),y=Object(l.a)(_,2),O=y[0],j=y[1],S=Object(n.useState)(!1),N=Object(l.a)(S,2),k=N[0],A=N[1],L=Object(n.useState)(!1),U=Object(l.a)(L,2),D=U[0],I=U[1],F=Object(n.useState)(!1),T=Object(l.a)(F,2),M=T[0],P=T[1],B=Object(n.useState)(null),z=Object(l.a)(B,2),V=z[0],Y=z[1],H=Object(n.useState)(null),W=Object(l.a)(H,2),G=W[0],Z=W[1],Q=Object(n.useState)(!1),J=Object(l.a)(Q,2),K=J[0],q=J[1],X=function(e){return function(t){return(t.data.name+"").toLowerCase().includes(e.toLowerCase())||!e}};Object(n.useEffect)((function(){f&&(o.a.createElement(o.a.Fragment,null,t.filter(X(f)).map((function(e){return o.a.createElement("p",{key:e.id},e.name)}))).props.children.length>0?q(!0):q(!1));if(t){var e=t.findIndex((function(e,t){return e.id===i}));e>=0?a(e):-1===e&&(a(e),c.push("/"))}}),[f,t,i,c,a]),Object(n.useEffect)((function(){t&&(t.length>0?(A(!1),j(!0)):0===t.length&&-1===r&&(A(!0),j(!0)))}),[r,t]),Object(n.useEffect)((function(){$()}),[G]);var $=function(){v.collection("users").onSnapshot((function(e){return Z(e.docs.map((function(e){return e.data()})))}))},ee=function(){Y(null),I(!0)},te=function(e){Y(e.currentTarget)},ne=[{title:"Profile",onClick:function(){return ee()},id:1e5*Math.random()},{title:"Archived",onClick:function(){w("Archive is not yet available!","archive","top-center")},id:1e5*Math.random()},{title:"Starred",onClick:function(){w("Starred is not yet available!","starred","top-center")},id:1e5*Math.random()},{title:"Settings",onClick:function(){w("Settings is not yet available!","settings","top-center")},id:1e5*Math.random()},{title:"Logout",onClick:function(){!0===u.isAnonymous?E.currentUser.delete().then((function(){c.push("/")})).catch((function(e){console.log("error deleting anonymous user",e)})):E.signOut()},id:1e5*Math.random()}];return o.a.createElement("div",{className:"sidebar"},o.a.createElement("div",{className:"sidebar__header"},o.a.createElement(C,{id:"UserProfile",photoURL:u.photoURL,onClick:function(){return ee()}}),o.a.createElement(ae,{drawerLeft:D,setDrawerLeft:I,db:v,auth:E,storage:g}),o.a.createElement("div",{className:"sidebar__headerRight"},o.a.createElement(Ee,{drawer2:M,setDrawer2:P,userData:G,db:v,auth:E,storage:g}),o.a.createElement(ge,{icon:o.a.createElement(x.a,{style:{color:"#de5751"}}),name:"New Chat",onClick:function(){return Y(null),void P(!0)}}),o.a.createElement(ge,{name:"Menu",icon:o.a.createElement(be.a,{style:{color:"#de5751"}}),onClick:te}),o.a.createElement(R,{menuLists:ne,menu:V,handleMenuOpen:te,handleMenuClose:function(){Y(null)}}))),o.a.createElement(le,{search:f,setSearch:b,placeholder:"Search or start new chat"}),o.a.createElement("div",{className:"sidebar__chats"},O?o.a.createElement(o.a.Fragment,null,f?o.a.createElement(o.a.Fragment,null,K?o.a.createElement("div",null,t.filter(X(f)).map((function(e){return o.a.createElement(ue,{key:e.id,id:e.id,name:e.data.name})}))):o.a.createElement("div",{className:"sidebar__chatsContainer_empty"},o.a.createElement("span",null,"No chat room found"))):o.a.createElement(o.a.Fragment,null,t.map((function(e){return o.a.createElement(ue,{key:e.id,id:e.id,name:e.data.name,owner:e.data.roomOwner})})))):o.a.createElement("div",{className:"sidebar__chatsContainer_loading"},o.a.createElement("div",null,o.a.createElement(de.a,null))),k&&O?o.a.createElement("div",{className:"sidebar__chatsContainer_empty"},o.a.createElement("span",null,"No chats")):null))},we=a(16),ye=(a(390),Object(G.a)((function(e){var t;return{root:{display:"flex"},drawerPaper:(t={},Object(we.a)(t,e.breakpoints.only("xs"),{width:"100vw"}),Object(we.a)(t,e.breakpoints.up("sm"),{position:"absolute"}),t)}})));var Oe=function(e){var t=e.content,a=e.drawerRight,n=ye();return o.a.createElement("div",null,o.a.createElement(H.a,{anchor:"right",variant:"persistent",open:a,classes:{paper:n.drawerPaper}},t))},je=a(459),Se=a(115),Ne=a.n(Se),Ce=(a(391),a(77));var ke=function(e){var t=e.drawerRightSearch,a=e.setDrawerRightSearch,r=e.messages,c=e.user,i=Object(n.useState)(""),s=Object(l.a)(i,2),m=s[0],u=s[1],d=Object(n.useState)(!1),p=Object(l.a)(d,2),h=p[0],E=p[1],f=function(e){return function(t){return(t.message+""+t.caption).toLowerCase().includes(e.toLowerCase())||!e}},g=function(e){var t=Ce.AES.decrypt(e,"my-secret-key@123").toString(Ce.enc.Utf8);return e?t:e};return Object(n.useEffect)((function(){m&&(o.a.createElement(o.a.Fragment,null,r.filter(f(m)).map((function(e){return o.a.createElement("p",{key:e.id},e.message?g(e.message):"",e.caption)}))).props.children.length>0?(E(!0),console.log("search message sucess")):(E(!1),console.log("search message fail")))}),[m,r]),o.a.createElement("div",null,o.a.createElement(Oe,{drawerRight:t,content:o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"drawerRight__header"},o.a.createElement(B.a,{onClick:function(){a(!1)}},o.a.createElement(V.a,null)),o.a.createElement("p",null,"Search Messages")),o.a.createElement(le,{search:m,setSearch:u,placeholder:"Search..."}),o.a.createElement("div",{className:"drawerRight__content ".concat(!0===h&&m.length>0&&"drawerRight__content_searched")},m.length>0?o.a.createElement(o.a.Fragment,null,h?o.a.createElement(o.a.Fragment,null,r.filter(f(m)).map((function(e){var t;return o.a.createElement("div",{key:e.id,className:"drawerRight__content_searched_message"},o.a.createElement("p",null,new Date(null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toLocaleTimeString("en-US",{hour:"numeric",hour12:!0,minute:"numeric"}),o.a.createElement("br",null)),o.a.createElement("p",{id:"last_p"},e.uid===c.uid?o.a.createElement(Ne.a,null):null,e.message?g(e.message):"",e.caption),o.a.createElement(je.a,null))}))):o.a.createElement("p",null,"No message found")):o.a.createElement("p",null,"Search for messages in this room.")))}))},xe=a(221),Ae=a.n(xe);a(392);var Le=function(e){var t=e.drawerRightInfo,a=e.setDrawerRightInfo;return e.messages,e.user,o.a.createElement("div",null,o.a.createElement(Oe,{drawerRight:t,content:o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"drawer-right-info__header"},o.a.createElement(B.a,{onClick:function(){a(!1)}},o.a.createElement(V.a,{style:{color:"#de5751"}})),o.a.createElement("p",{style:{color:"#de5751"}},"Contact Info")),o.a.createElement("div",{className:"drawer-right-info-content"},o.a.createElement("div",{className:"drawer-right-info-content__photo"},o.a.createElement("div",{className:"profilePhoto"},o.a.createElement(F.a,{in:t,style:{transitionDelay:t?"300ms":"0ms"}},o.a.createElement(N.a,null,o.a.createElement(Ae.a,null))),o.a.createElement("div",{className:"profilePhoto__layer_top"},o.a.createElement("div",{className:"profilePhoto__text"},o.a.createElement(Q.a,null),o.a.createElement("p",null,"CHANGE"),o.a.createElement("p",null,"PROFILE PHOTO")))))))}))},Re=a(463);a(393);var Ue=function(e){var t=e.roomCreatedBy,a=e.roomOwner,r=e.roomName,c=e.roomId,i=(e._roomId,e.messages),s=e.db,d=e.history,p=e.isRoomExist,h=m(),E=Object(l.a)(h,1)[0].user,f=Object(n.useState)(!1),g=Object(l.a)(f,2),v=g[0],b=g[1],_=Object(n.useState)(!1),y=Object(l.a)(_,2),O=y[0],j=y[1],S=Object(n.useState)(null),C=Object(l.a)(S,2),k=C[0],x=C[1],A=Object(n.useState)(""),L=Object(l.a)(A,2),U=L[0],D=L[1],I=Object(n.useState)(!1),F=Object(l.a)(I,2),T=F[0],M=F[1],P=Object(n.useState)(!1),z=Object(l.a)(P,2),V=z[0],Y=z[1];Object(n.useEffect)((function(){var e;E.uid&&s.collection("users").doc(E.uid).get().then((function(e){e.exists&&D(e.data().role)})).catch((function(e){w("".concat(e),"errorAbout","top-center")})),(null===(e=i[i.length-1])||void 0===e?void 0:e.timestamp)?M(!0):M(!1),i[i.length-1]?Y(!0):Y(!1),p>=0&&(j(!1),b(!1))}),[E.uid,E.displayName,E.isAnonymous,s,i,c,p]);var H=function(e){x(e.currentTarget)},W=[{title:"Contact info",onClick:function(){return j(!0),void x(null)},id:1e5*Math.random()},{title:"Select messages",onClick:function(){w("Select Messages is not yet  available!","selectMessages","top-center")},id:1e5*Math.random()},{title:"Mute notifications",onClick:function(){w("Mute Notifications is not yet available!","muteNotifications","top-center")},id:1e5*Math.random()},{title:"Clear messages",onClick:function(){w("Clear Messages is not yet available!","clearMessages","top-center")},id:1e5*Math.random()},{title:"Delete Room",onClick:function(){return function(){var e="roomDeleted";a===E.uid||"admin"===U?(s.collection("rooms").doc(c).delete().then((function(){w("Room successfully deleted!",e,"top-center")})).catch((function(t){w("Error removing room! ".concat(t),e,"top-center")})),d.push("/")):w("You are not allowed to delete room ".concat(r,". Only the admin or room owner ").concat(t),e,"top-center")}()},id:1e5*Math.random()}];return o.a.createElement("div",{className:"chat__header"},o.a.createElement(ke,{drawerRightSearch:v,setDrawerRightSearch:b,roomId:c,messages:i,db:s,user:E}),o.a.createElement(Le,{drawerRightInfo:O,setDrawerRightInfo:j,roomId:c,messages:i,db:s,user:E}),o.a.createElement(Re.a,{smUp:!0},o.a.createElement(u.b,{to:"/"},o.a.createElement("div",{className:"chat__back_button"},o.a.createElement(B.a,null,o.a.createElement(K.a,{style:{color:"#de5751"}}))))),o.a.createElement(N.a,null,r[0]),o.a.createElement("div",{className:"chat__headerInfo"},o.a.createElement("h3",null,r),V?o.a.createElement(o.a.Fragment,null,T?o.a.createElement("p",null,"Last seen ",function(){var e,t;return new Date(null===(e=i[i.length-1])||void 0===e||null===(t=e.timestamp)||void 0===t?void 0:t.toDate()).toLocaleTimeString([],{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",hour12:!0,minute:"numeric"})}()):o.a.createElement("p",null,"Last seen ",(new Date).toLocaleTimeString([],{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",hour12:!0,minute:"numeric"}))):null),o.a.createElement("div",{className:"chat__headerRight"},o.a.createElement(ge,{name:"Search",icon:o.a.createElement(oe.a,{style:{color:"#de5751"}}),onClick:function(){b(!0)}}),o.a.createElement(ge,{name:"Menu",icon:o.a.createElement(be.a,{style:{color:"#de5751"}}),onClick:H}),o.a.createElement(R,{menuLists:W,menu:k,handleMenuOpen:H,handleMenuClose:function(){x(null)}})))},De=a(116),Ie=a.n(De),Fe=a(222),Te=a.n(Fe),Me=a(223),Pe=a.n(Me),Be=(a(411),a(77));var ze=function(e){var t=e.roomOwner,a=e.roomCreatedBy,r=e.messages,c=e.user,i=e.roomId,s=e.isRoomExist,m=Object(n.useRef)(null),u=Object(n.useState)(!1),d=Object(l.a)(u,2),p=d[0],h=d[1];Object(n.useEffect)((function(){s>=0&&h(!1)}),[s]);var E=function(){h(!0)},f=function(){h(!1)};return Object(n.useEffect)((function(){i&&m.current.scrollIntoView({behavior:"auto"})}),[r,i]),o.a.createElement("div",null,o.a.createElement("p",{className:"chat__message_reminder"},o.a.createElement(Te.a,null)," Welcome to Tattle. Messages are encrpyted."),o.a.createElement("p",{className:"chat__message_reminder chat__createdBy"},t===c.uid?"You created this group":"".concat(a," created this group")),r.map((function(e){return o.a.createElement("div",{key:e.id,className:"chat__message \n                    ".concat(e.uid===c.uid&&"chat__sender"," \n                    ").concat(e.photo&&"chat__message_media_image","\n                    ").concat(e.video&&"chat__message_media_video","\n                    ").concat(e.video&&!e.caption&&"chat__message_media_video_noCaption"," ")},o.a.createElement("span",{className:"chat__name ".concat(e.uid===c.uid&&"chat__name_sender")},e.name),o.a.createElement("div",{className:"chat__body_image_container"},e.photo?o.a.createElement(o.a.Fragment,null,o.a.createElement("img",{alt:"",className:"chat__body_image",src:e.photo})):null),o.a.createElement("div",{className:"chat__body_video_container"},e.video?o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"player-wrapper"},o.a.createElement(Ie.a,{className:"react-player",width:"100%",height:"100%",url:e.video,controls:!0,onPlay:E,onPause:f,onEnded:f}))):null),o.a.createElement("div",{className:"chat__message_box"},o.a.createElement("div",{className:"chat__message_box_text ".concat(e.uid===c.uid&&"chat__message_box_text_sender","\n              ").concat(e.photo&&!e.caption&&"chat__message_box_text_no_caption"," ")},e.message?function(e){var t=Be.AES.decrypt(e,"my-secret-key@123").toString(Be.enc.Utf8);return e?t:e}(e.message):null,e.caption?e.caption:null,e.url?o.a.createElement("a",{target:"_blank",href:"".concat(e.url),rel:"noopener noreferrer"},e.url):null,o.a.createElement("div",{className:"chat__timestamp_container ".concat(e.uid===c.uid&&"chat__timestamp_container_sender")},e.timestamp?o.a.createElement("div",{className:"chat__timestamp \n                                    ".concat(e.photo&&!e.caption&&"chat__timestamp_media_photo","  \n                                    ").concat(e.video&&!e.caption&&"chat__timestamp_media_video","\n                                    ").concat(e.video&&!e.caption&&!0===p&&"chat__timestamp_media_displayNone")},o.a.createElement("span",null,new Date(e.timestamp.toDate()).toLocaleTimeString("en-US",{hour:"numeric",hour12:!0,minute:"numeric"}),e.uid===c.uid?o.a.createElement(Ne.a,null):null)):o.a.createElement("div",{className:"chat__timestamp"},o.a.createElement("span",null,(new Date).toLocaleTimeString("en-US",{hour:"numeric",hour12:!0,minute:"numeric"}),e.uid===c.uid?o.a.createElement(Pe.a,null):null))))))})),o.a.createElement("div",{ref:m}))},Ve=a(460),Ye=a(117),He=a.n(Ye),We=(a(412),Object(G.a)((function(e){var t;return{root:{display:"flex"},drawerPaper:{position:"absolute",width:"100%"},paperAnchorBottom:(t={left:"auto",right:0,bottom:0,maxHeight:"100%"},Object(we.a)(t,e.breakpoints.up("xs"),{top:52}),Object(we.a)(t,e.breakpoints.up("sm"),{top:65}),Object(we.a)(t,e.breakpoints.up("md"),{top:65}),Object(we.a)(t,e.breakpoints.up("lg"),{top:65}),t)}})));var Ge,Ze=function(e){var t=e.drawerBottom,a=e.setDrawerBottom,r=e.fileImageUrl,c=e.fileVideoUrl,i=e.setFileVideoUrl,s=e.setFileImageUrl,u=e.firebase,p=e.db,h=(e.storage,We()),E=m(),f=Object(l.a)(E,1)[0].user,g=Object(n.useState)(""),v=Object(l.a)(g,2),b=v[0],_=v[1],w=Object(d.h)().roomId;return o.a.createElement("div",null,o.a.createElement(H.a,{variant:"persistent",anchor:"bottom",open:t,classes:{paper:h.drawerPaper,paperAnchorBottom:h.paperAnchorBottom}},o.a.createElement("div",{className:"drawerBottom__header"},o.a.createElement("div",{className:"drawerBottom__header_container"},o.a.createElement(B.a,{onClick:function(){a(!1)}},o.a.createElement(V.a,null)),o.a.createElement("p",null,"Preview"))),o.a.createElement("div",{className:"drawerBottom__content"},o.a.createElement("div",{className:"drawerBottom__content_photo"},r?o.a.createElement("img",{src:r,alt:""}):o.a.createElement("div",{className:"drawerBottom__content_video"},o.a.createElement("div",{className:"player-wrapper"},o.a.createElement(Ie.a,{className:"react-player",width:"100%",height:"50%",url:c,controls:!0})))),o.a.createElement("div",{className:"drawerBottom__content_caption"},o.a.createElement("input",{type:"text",placeholder:"Add a caption...",value:b,onChange:function(e){return _(e.target.value)}}),o.a.createElement(Ve.a,{color:"primary","aria-label":"send",size:"large",onClick:function(e){e.preventDefault(),r&&(p.collection("rooms").doc(w).collection("messages").add({photo:r,name:f.displayName,uid:f.uid,caption:b,timestamp:u.firestore.FieldValue.serverTimestamp()}).then((function(e){p.collection("rooms").doc(w).collection("messages").doc(e.id).set({id:e.id},{merge:!0})})).catch((function(e){console.error("Error adding document: ",e)})),s(null)),c&&(p.collection("rooms").doc(w).collection("messages").add({video:c,name:f.displayName,uid:f.uid,caption:b,timestamp:u.firestore.FieldValue.serverTimestamp()}).then((function(e){p.collection("rooms").doc(w).collection("messages").doc(e.id).set({id:e.id},{merge:!0})})).catch((function(e){console.error("Error adding document: ",e)})),i(null)),_(""),a(!1)}},o.a.createElement("div",{className:"chat__icon"},o.a.createElement(He.a,null))))),o.a.createElement("div",{className:"drawerBottom__footer"},o.a.createElement("div",null,r?o.a.createElement("img",{src:r,alt:""}):null))))},Qe=a(152),Je=a(420),Ke=a(461),qe=a(234),Xe=a.n(qe),$e=a(235),et=a.n($e),tt=a(231),at=a.n(tt),nt=a(233),ot=a.n(nt),rt=a(232),ct=a.n(rt),lt=a(229),it=a.n(lt),st=a(230),mt=a.n(st),ut=(a(414),a(415),a(224)),dt=a(225).a.div(Ge||(Ge=Object(ut.a)(["\n  height: ",";\n"])),(function(e){return e.drawerBottom?"100%":"62px"})),pt=a(77),ht=a.n(pt),Et=[{title:"Room",icon:o.a.createElement(it.a,null),id:1e5*Math.random()},{title:"Contact",icon:o.a.createElement(mt.a,null),id:1e5*Math.random()},{title:"Document",icon:o.a.createElement(at.a,null),id:1e5*Math.random()},{title:"Camera",icon:o.a.createElement(ct.a,null),id:1e5*Math.random()},{title:"Photos & Videos",icon:o.a.createElement(ot.a,null),id:1e5*Math.random()}];var ft=function(e){var t=e.roomName,a=e.roomId,r=e.db,c=e.firebase,i=e.storage,s=m(),u=Object(l.a)(s,1)[0].user,d=Object(n.useState)(""),p=Object(l.a)(d,2),h=p[0],E=p[1],f=Object(n.useState)(!1),g=Object(l.a)(f,2),v=g[0],b=g[1],_=Object(n.useState)(null),y=Object(l.a)(_,2),O=y[0],j=y[1],S=Object(n.useState)(null),N=Object(l.a)(S,2),C=N[0],k=N[1],x=Object(n.useState)(!1),A=Object(l.a)(x,2),L=A[0],R=A[1],U=Object(n.useState)(!1),F=Object(l.a)(U,2),T=F[0],M=F[1],P=function(){w("All icons have the same functions, you can only upload images, gifs and videos!","attach","top-center"),M(!1===T)},B=function(e){var t=e.native;E(h+t)},z=function(){b(!1)},Y=function(){var e=Object(I.a)(D.a.mark((function e(a){var n,o,r,c,l,s;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("fileSizeToastId",!((n=a.target.files[0]).size>12582912)){e.next=6;break}w("File should not exceed more than 12MB","fileSizeToastId","top-center"),e.next=32;break;case 6:if(o=i.ref(),!n.type.match("image.*")){e.next=20;break}return r=o.child("rooms/".concat(t,"/images/")),c=r.child((new Date).getTime()+" "+n.name),e.next=12,c.put(n);case 12:return e.t0=j,e.next=15,c.getDownloadURL();case 15:e.t1=e.sent,(0,e.t0)(e.t1),console.log("uploading image",O),e.next=31;break;case 20:if(!n.type.match("video.*")){e.next=31;break}return l=o.child("rooms/".concat(t,"/videos")),s=l.child((new Date).getTime()+" "+n.name),e.next=25,s.put(n);case 25:return e.t2=k,e.next=28,s.getDownloadURL();case 28:e.t3=e.sent,(0,e.t2)(e.t3),console.log("uploading video",C);case 31:R(!0);case 32:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return o.a.createElement(dt,{drawerBottom:L,className:"chat__footer"},o.a.createElement(Ze,{drawerBottom:L,setDrawerBottom:R,fileVideoUrl:C,fileImageUrl:O,setFileImageUrl:j,setFileVideoUrl:k,roomId:a,db:r,firebase:c,storage:i}),v?o.a.createElement(Re.a,{only:["xs"]},o.a.createElement(ge,{name:"Close",icon:o.a.createElement(V.a,{style:{color:"#de5751"}}),onClick:function(){return z()}})):null,o.a.createElement(ge,{name:"Emoticons",icon:o.a.createElement(Xe.a,{style:{color:"#de5751"}}),onClick:function(){b(!0)}}),v?o.a.createElement(o.a.Fragment,null,o.a.createElement(Re.a,{only:["xs"]},o.a.createElement(Qe.a,{onSelect:B})),o.a.createElement(Re.a,{smUp:!0},o.a.createElement(Ke.a,{onClickAway:z},o.a.createElement(Qe.a,{onSelect:B})))):null,o.a.createElement("div",null,o.a.createElement(ge,{name:"Attach",icon:o.a.createElement(et.a,{style:{color:"#de5751"}}),onClick:P}),T?o.a.createElement(Ke.a,{onClickAway:function(){M(!1)}},o.a.createElement("div",{className:"chat__attachFile"},Et.map((function(e){return o.a.createElement(Je.a,{key:e.id,direction:"up",in:P,mountOnEnter:!0,unmountOnExit:!0},o.a.createElement(fe.a,{title:o.a.createElement("span",{style:{fontSize:"14px",padding:"8px 5px 8px 5px"}},e.title),placement:"left"},o.a.createElement(Ve.a,{color:"primary","aria-label":"person"},o.a.createElement("div",{className:"chat__icon"},o.a.createElement("label",{htmlFor:"file-input"},e.icon),o.a.createElement("input",{id:"file-input",type:"file",onChange:Y,accept:"image/*,video/mp4,video/3gpp,video/quicktime"})))))})))):null),o.a.createElement("form",null,o.a.createElement("textarea",{required:!0,value:h,onChange:function(e){return E(e.target.value)},placeholder:"Type a message",type:"text",rows:"1",onKeyDown:function(e){if(13===e.keyCode&&!1===e.shiftKey){e.preventDefault();a&&(/^((?:https?:)?\/\/)?((?:www|m)\.)?((?:youtube\.com|youtu.be))(\/(?:[\w\\-]+\?v=|embed\/|v\/)?)([\w\\-]+)(\S+)?$/.test(h)||/^https?:\/\/www\.facebook\.com.*\/(video(s)?|watch|story)(\.php?|\/).+$/.test(h)||/(http|https)?:\/\/(www\.|player\.)?vimeo\.com\/(?:channels\/(?:\w+\/)?|groups\/([^\\/]*)\/videos\/|video\/|)(\d+)(?:|\/\?)/.test(h)||/^https?:\/\/(soundcloud\.com|snd\.sc)\/(.*)$/.test(h)||/^.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/.test(h)?r.collection("rooms").doc(a).collection("messages").add({message:"",video:h,name:u.displayName,uid:u.uid,timestamp:c.firestore.FieldValue.serverTimestamp()}).then((function(e){console.log("Document written with ID: ",e.id),r.collection("rooms").doc(a).collection("messages").doc(e.id).set({id:e.id},{merge:!0})})).catch((function(e){console.error("Error adding document: ",e)})):/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\\.-]+)+[\w\-\\._~:/?#[\]@!\\$&'\\(\\)\\*\\+,;=.]+$/.test(h)?r.collection("rooms").doc(a).collection("messages").add({message:"",url:h,name:u.displayName,uid:u.uid,timestamp:c.firestore.FieldValue.serverTimestamp()}).then((function(e){console.log("Document written with ID: ",e.id),r.collection("rooms").doc(a).collection("messages").doc(e.id).set({id:e.id},{merge:!0})})).catch((function(e){console.error("Error adding document: ",e)})):/\S/.test(h)&&r.collection("rooms").doc(a).collection("messages").add({message:ht.a.AES.encrypt(h,"my-secret-key@123").toString(),name:u.displayName,uid:u.uid,timestamp:c.firestore.FieldValue.serverTimestamp()}).then((function(e){r.collection("rooms").doc(a).collection("messages").doc(e.id).set({id:e.id},{merge:!0})})).catch((function(e){console.error("Error adding document: ",e)}))),E(""),b(!1)}}})),o.a.createElement(ge,{name:"Send Message",icon:o.a.createElement(He.a,{style:{color:"#de5751"}}),onClick:function(){a&&(/^((?:https?:)?\/\/)?((?:www|m)\.)?((?:youtube\.com|youtu.be))(\/(?:[\w\\-]+\?v=|embed\/|v\/)?)([\w\\-]+)(\S+)?$/.test(h)||/^https?:\/\/www\.facebook\.com.*\/(video(s)?|watch|story)(\.php?|\/).+$/.test(h)||/(http|https)?:\/\/(www\.|player\.)?vimeo\.com\/(?:channels\/(?:\w+\/)?|groups\/([^\\/]*)\/videos\/|video\/|)(\d+)(?:|\/\?)/.test(h)||/^https?:\/\/(soundcloud\.com|snd\.sc)\/(.*)$/.test(h)||/^.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/.test(h)?r.collection("rooms").doc(a).collection("messages").add({message:"",video:h,name:u.displayName,uid:u.uid,timestamp:c.firestore.FieldValue.serverTimestamp()}).then((function(e){console.log("Document written with ID: ",e.id),r.collection("rooms").doc(a).collection("messages").doc(e.id).set({id:e.id},{merge:!0})})).catch((function(e){console.error("Error adding document: ",e)})):/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\\.-]+)+[\w\-\\._~:/?#[\]@!\\$&'\\(\\)\\*\\+,;=.]+$/.test(h)?r.collection("rooms").doc(a).collection("messages").add({message:"",url:h,name:u.displayName,uid:u.uid,timestamp:c.firestore.FieldValue.serverTimestamp()}).then((function(e){console.log("Document written with ID: ",e.id),r.collection("rooms").doc(a).collection("messages").doc(e.id).set({id:e.id},{merge:!0})})).catch((function(e){console.error("Error adding document: ",e)})):/\S/.test(h)&&r.collection("rooms").doc(a).collection("messages").add({message:ht.a.AES.encrypt(h,"my-secret-key@123").toString(),name:u.displayName,uid:u.uid,timestamp:c.firestore.FieldValue.serverTimestamp()}).then((function(e){r.collection("rooms").doc(a).collection("messages").doc(e.id).set({id:e.id},{merge:!0})})).catch((function(e){console.error("Error adding document: ",e)}))),E(""),b(!1)}}))},gt=a(236),vt=a.n(gt);a(416);var bt=function(e){var t=e.showLandingScreenPhoto;return o.a.createElement("div",{className:"chat-landing-screen"},o.a.createElement("div",null,o.a.createElement(F.a,{in:t,style:{transitionDelay:t?"300ms":"0ms"}},o.a.createElement("img",{className:"chat-landing-screen__photo",src:"https://firebasestorage.googleapis.com/v0/b/tattle-9359.appspot.com/o/Folder%2Flogo.webp?alt=media&token=c0d6ec1c-5261-4864-a820-539a731fb7d1",alt:"TattleLogo"}))),o.a.createElement("div",{className:"chat-landing-screen__title"},o.a.createElement("p",null,"Keeps you Connected")),o.a.createElement("div",null,o.a.createElement("p",null,"Tattle is driven by a fascination for mobile technology that was once viewed as a passing trend.")),o.a.createElement(je.a,null),o.a.createElement("div",{className:"chat-landing-screen__footer"},o.a.createElement(vt.a,null),o.a.createElement("p",null,"Tattle is available for Windows."),o.a.createElement("a",{target:"_blank",href:"https://tattle-9359.web.app",rel:"noopener noreferrer"},"Get it here.")))};a(216),a(417);var _t=function(e){var t=e.isRoomExist,a=Object(d.g)(),r=m(),c=Object(l.a)(r,1)[0].user,i=Object(d.h)().roomId,s=Object(n.useState)(""),u=Object(l.a)(s,2),h=u[0],E=u[1],f=Object(n.useState)(""),b=Object(l.a)(f,2),_=b[0],w=b[1],y=Object(n.useState)(""),O=Object(l.a)(y,2),j=O[0],S=O[1],N=Object(n.useState)(""),C=Object(l.a)(N,2),k=C[0],x=C[1],A=Object(n.useState)([]),L=Object(l.a)(A,2),R=L[0],U=L[1],D=Object(n.useState)(!1),I=Object(l.a)(D,2),F=I[0],T=I[1],M=Object(n.useState)(!1),P=Object(l.a)(M,2),B=P[0],z=P[1];return Object(n.useEffect)((function(){i?(v.collection("rooms").doc(i).onSnapshot((function(e){var t,a,n,o;w(null===(t=e.data())||void 0===t?void 0:t.name),S(null===(a=e.data())||void 0===a?void 0:a.createdBy),x(null===(n=e.data())||void 0===n?void 0:n.roomOwner),E(null===(o=e.data())||void 0===o?void 0:o.id)})),v.collection("rooms").doc(i).collection("messages").orderBy("timestamp","asc").onSnapshot((function(e){U(e.docs.map((function(e){return e.data()}))),T(!0)})),z(!1)):(z(!0),a.push("/"))}),[i,a]),o.a.createElement("div",{className:"chat"},i?o.a.createElement(o.a.Fragment,null,o.a.createElement("div",null,o.a.createElement(Ue,{roomCreatedBy:j,roomOwner:k,roomName:_,roomId:i,_roomId:h,messages:R,db:v,history:a,isRoomExist:t})),o.a.createElement("div",{className:"chat__body"},F?o.a.createElement(ze,{roomCreatedBy:j,roomOwner:k,roomId:i,messages:R,user:c,isRoomExist:t}):o.a.createElement("div",{className:"chat__body_loading"},o.a.createElement("div",null,o.a.createElement(de.a,null)))),o.a.createElement("div",null,o.a.createElement(ft,{roomName:_,roomId:i,db:v,firebase:p.a,storage:g}))):o.a.createElement(bt,{showLandingScreenPhoto:B}))},wt=a(462);a(418);var yt=function(){var e=m(),t=Object(l.a)(e,2),a=t[0].user,r=t[1],c=Object(n.useState)([]),i=Object(l.a)(c,2),s=i[0],h=i[1],f=Object(n.useState)(""),g=Object(l.a)(f,2),y=g[0],O=g[1],j=Object(n.useState)(!1),N=Object(l.a)(j,2),C=N[0],k=N[1];return Object(n.useEffect)((function(){var e=E.onAuthStateChanged((function(e){if(e){if(r(b(e)),k(!0),v.collection("rooms").orderBy("timestamp","desc").onSnapshot((function(e){return h(e.docs.map((function(e){return{id:e.id,data:e.data()}})))})),!0===e.isAnonymous&&null===e.displayName){var t="anonymous"+Math.floor(1e6*Math.random());E.currentUser.updateProfile({displayName:t,photoURL:""}),v.collection("users").doc(e.uid).set({name:t,about:"Hey there! I am using Tattle.",photoURL:"https://avatars.dicebear.com/api/human/ugtjh.svg",role:"anonymous",email:t+"@anonymous.com",dateJoined:p.a.firestore.FieldValue.serverTimestamp()}).then((function(){console.log("Document successfully updated!")})).catch((function(e){console.error("Error updating document: ",e)}))}if(e.uid&&!1===e.isAnonymous&&null!==e.photoURL){v.collection("users").doc(e.uid).get().then((function(t){t.exists||v.collection("users").doc(e.uid).set({name:e.displayName,about:"Hey there! I am using Tattle.",photoURL:a.photoURL,role:"regular",email:e.email,dateJoined:p.a.firestore.FieldValue.serverTimestamp()})})).catch((function(e){w("".concat(e),"errorAbout","top-center")}))}else if(e.uid&&!1===e.isAnonymous&&null===e.photoURL){v.collection("users").doc(e.uid).get().then((function(t){t.exists?console.log("USER EXIST"):v.collection("users").doc(e.uid).set({name:e.displayName,about:"Hey there! I am using Tattle.",photoURL:"",role:"regular",email:e.email,dateJoined:p.a.firestore.FieldValue.serverTimestamp()})})).catch((function(e){w("".concat(e),"errorAbout","top-center")}))}}else r(b(null)),k(!0)}));return function(){e()}}),[r,a]),o.a.createElement("div",{className:"app ".concat(!1===C&&"app-no-bg")},C?o.a.createElement(o.a.Fragment,null,o.a.createElement(_.a,{position:"top-center",autoClose:5e3,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0}),a?o.a.createElement("div",{className:"app__body"},o.a.createElement(u.a,null,o.a.createElement(d.d,null,o.a.createElement(d.b,{exact:!0,path:"/"},o.a.createElement(_e,{rooms:s,setIsRoomExist:O,isRoomExist:y}),o.a.createElement(Re.a,{only:["xs"]}," ",o.a.createElement(_t,{isRoomExist:y}))),o.a.createElement(d.b,{exact:!0,path:"/rooms/:roomId"},o.a.createElement(Re.a,{only:["xs"]}," ",o.a.createElement(_e,{rooms:s,setIsRoomExist:O,isRoomExist:y})),o.a.createElement(_t,{isRoomExist:y})),o.a.createElement(d.b,{path:"*"},o.a.createElement(d.a,{to:"/"}))))):o.a.createElement(S,null)):o.a.createElement("div",{className:"app__loading"},o.a.createElement("div",null,o.a.createElement("div",{className:"app__loading_circular"},o.a.createElement(de.a,null)),o.a.createElement("div",{className:"app__loading_linear"},o.a.createElement(wt.a,null)))))},Ot=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function jt(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var St=a(151),Nt="SET_USER",Ct=function(e,t){switch(t.type){case Nt:return Object(St.a)(Object(St.a)({},e),{},{user:t.user});default:return e}};c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(s,{initialState:{user:null},reducer:Ct},o.a.createElement(yt,null))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");Ot?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):jt(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):jt(t,e)}))}}()}},[[419,1,2]]]);
//# sourceMappingURL=main.b6e4e3a0.chunk.js.map